(function(e){function t(t){for(var a,s,o=t[0],l=t[1],c=t[2],h=0,d=[];h<o.length;h++)s=o[h],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&d.push(n[s][0]),n[s]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);u&&u(t);while(d.length)d.shift()();return r.push.apply(r,c||[]),i()}function i(){for(var e,t=0;t<r.length;t++){for(var i=r[t],a=!0,o=1;o<i.length;o++){var l=i[o];0!==n[l]&&(a=!1)}a&&(r.splice(t--,1),e=s(s.s=i[0]))}return e}var a={},n={app:0},r=[];function s(t){if(a[t])return a[t].exports;var i=a[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=e,s.c=a,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(i,a,function(t){return e[t]}.bind(null,a));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var u=l;r.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("56d7")},1:function(e,t){},2:function(e,t){},3:function(e,t){},4:function(e,t){},4678:function(e,t,i){var a={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-SG":"cdab","./en-SG.js":"cdab","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-nz":"6f50","./en-nz.js":"6f50","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-tw":"90ea","./zh-tw.js":"90ea"};function n(e){var t=r(e);return i(t)}function r(e){if(!i.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}n.keys=function(){return Object.keys(a)},n.resolve=r,e.exports=n,n.id="4678"},"56d7":function(e,t,i){"use strict";i.r(t);var a={};i.r(a),i.d(a,"ajax",(function(){return pi})),i.d(a,"getId",(function(){return gi})),i.d(a,"max",(function(){return bi})),i.d(a,"min",(function(){return yi})),i.d(a,"Observer",(function(){return mi})),i.d(a,"extend",(function(){return wi})),i.d(a,"style",(function(){return ki})),i.d(a,"requestAnimationFrame",(function(){return xi})),i.d(a,"frame",(function(){return Ci})),i.d(a,"debounce",(function(){return Si.a})),i.d(a,"preventClick",(function(){return Ei})),i.d(a,"fetchFile",(function(){return ji}));i("e260"),i("e6cf"),i("cca6"),i("a79d");var n=i("2b0e"),r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-app",[i("m-app-bar"),i("v-content",[i("m-side-bar"),i("router-view")],1)],1)},s=[],o=(i("c975"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-app-bar",{attrs:{app:"",color:"primary",dark:""}},[i("v-toolbar-title",[e._v(e._s(e.name)+" ver. "+e._s(e.version))]),i("v-spacer"),i("v-btn",{attrs:{icon:""},on:{click:function(t){return e.to({name:"Home"})}}},[i("v-icon",[e._v("mdi-home")])],1)],1)}),l=[],c=(i("b0c0"),{name:"MAppBar",computed:{name:{get:function(){return this.$store.state.appName}},version:{get:function(){return this.$store.state.appVersion}}},methods:{to:function(e){var t="".concat(this.$options.name,":to");console.info(t,e),this.$router.push(e)}}}),u=c,h=i("2877"),d=i("6544"),f=i.n(d),v=i("40dc"),m=i("8336"),p=i("132d"),g=i("2fa4"),b=i("2a7f"),y=Object(h["a"])(u,o,l,!1,null,null,null),w=y.exports;f()(y,{VAppBar:v["a"],VBtn:m["a"],VIcon:p["a"],VSpacer:g["a"],VToolbarTitle:b["a"]});var k=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-navigation-drawer",{attrs:{app:"",dark:"","expand-on-hover":"","mini-variant":e.mini,permanent:""},on:{"update:miniVariant":function(t){e.mini=t},"update:mini-variant":function(t){e.mini=t}}},[i("v-list",{attrs:{dense:"",nav:""}},[e.mini?i("v-list-item",[i("v-list-item-action",[i("v-icon",[e._v("mdi-menu-open")])],1)],1):i("v-list-item",[i("v-text-field",{attrs:{label:e.search.label,"single-line":"",solo:"",dense:"",rounded:""},model:{value:e.search.key,callback:function(t){e.$set(e.search,"key",t)},expression:"search.key"}})],1),e.mini?e._e():i("v-list-item",[i("v-list-item-subtitle",[e._v(" "+e._s(e.$vuetify.lang.t("$vuetify.sidebar.files.title"))+" ")])],1),i("m-movie-upload-dialog",{scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[i("v-list-item",e._g({attrs:{ripple:""}},a),[i("v-list-item-action",[i("v-icon",[e._v("mdi-playlist-plus")])],1),i("v-list-item-title",[e._v(" "+e._s(e.$vuetify.lang.t("$vuetify.sidebar.files.add"))+" ")])],1)]}}])}),e.files.length>0?i("v-list-group",{attrs:{"prepend-icon":e.menu.icon},scopedSlots:e._u([{key:"activator",fn:function(){return[i("v-list-item-title",[e._v(" "+e._s(e.$vuetify.lang.t("$vuetify.sidebar.files.list"))+" ")])]},proxy:!0}],null,!1,979820808),model:{value:e.menu.open,callback:function(t){e.$set(e.menu,"open",t)},expression:"menu.open"}},e._l(e.files,(function(t){return i("v-list-item",{key:t.id,on:{click:function(i){return e.selectFile(t)}}},[i("v-list-item-title",[e._v(" "+e._s(t.name)+" "),i("v-spacer"),e._v(" ("+e._s(t.fps)+" fps) ")],1),i("v-list-item-action",[i("v-icon",[e._v("mdi-file-video")])],1)],1)})),1):e._e(),i("v-divider"),i("v-list-item",{attrs:{ripple:""},on:{click:e.clearCache}},[i("v-list-item-action",[i("v-icon",[e._v("mdi-database-remove")])],1),i("v-list-item-content",[i("v-list-item-title",[e._v(" "+e._s(e.$vuetify.lang.t("$vuetify.sidebar.cache.destroy"))+" ")])],1)],1),i("v-list-item",{attrs:{ripple:""},on:{click:e.importCache}},[i("v-list-item-action",[i("v-icon",[e._v("mdi-database-import")])],1),i("v-list-item-content",[i("v-list-item-title",[e._v(" "+e._s(e.$vuetify.lang.t("$vuetify.sidebar.cache.import"))+" ")])],1)],1),i("v-list-item",{attrs:{ripple:""},on:{click:e.exportCache}},[i("v-list-item-action",[i("v-icon",[e._v("mdi-database-export")])],1),i("v-list-item-content",[i("v-list-item-title",[e._v(" "+e._s(e.$vuetify.lang.t("$vuetify.sidebar.cache.export"))+" ")])],1)],1)],1)],1)},x=[],C=(i("a9e3"),i("d3b7"),i("ac1f"),i("3ca3"),i("841c"),i("1276"),i("498a"),i("ddb0"),i("2b3d"),i("d4ec")),_=i("bee2"),S=i("262e"),P=i("2caf"),E=i("ade3"),T=i("c1df"),j=i.n(T),R=i("0937"),M=function(e){Object(S["a"])(i,e);var t=Object(P["a"])(i);function i(){return Object(C["a"])(this,i),t.apply(this,arguments)}return Object(_["a"])(i,null,[{key:"fields",value:function(){return{id:this.attr(null),codec_name:this.string(""),bitrate:this.number(0),channel_layout:this.string("mono"),sample_fmt:this.string(""),sample_rate:this.number(0)}}}]),i}(R["a"]);Object(E["a"])(M,"entity","audioStreams");var O=function(e){Object(S["a"])(i,e);var t=Object(P["a"])(i);function i(){return Object(C["a"])(this,i),t.apply(this,arguments)}return Object(_["a"])(i,null,[{key:"fields",value:function(){return{id:this.attr(null),codec_name:this.string(""),pix_fmt:this.string(""),bitrate:this.number(0),fps:this.number(0),tbc:this.number(0),tbn:this.number(0),tbr:this.number(0)}}}]),i}(R["a"]);Object(E["a"])(O,"entity","videoStreams");var A=function(e){Object(S["a"])(i,e);var t=Object(P["a"])(i);function i(){return Object(C["a"])(this,i),t.apply(this,arguments)}return Object(_["a"])(i,null,[{key:"fields",value:function(){return{id:this.attr(null),width:this.attr(0),height:this.attr(0)}}}]),i}(R["a"]);Object(E["a"])(A,"entity","videoSizes");var $=function(e){Object(S["a"])(i,e);var t=Object(P["a"])(i);function i(){return Object(C["a"])(this,i),t.apply(this,arguments)}return Object(_["a"])(i,null,[{key:"fields",value:function(){return{id:this.attr(null),audioStream_id:this.attr(null),videoStream_id:this.attr(null),videoSize_id:this.attr(null),name:this.attr(""),fileSize:this.attr(""),fileType:this.attr(""),fps:this.number(0),dataUrl:this.attr(""),lastModifiedDate:this.string(j()().format()),currentTime:this.number(0),audioStream:this.belongsTo(M,"audioStream_id"),videoStream:this.belongsTo(O,"videoStream_id"),size:this.belongsTo(A,"videoSize_id")}}}]),i}(R["a"]);Object(E["a"])($,"entity","files");var V=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("m-base-form-dialog",{ref:"form",attrs:{title:"Movie Upload",isloading:e.video.loading},on:{valid:e.onValid},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[e._t("activator",[i("v-btn",e._g({attrs:{color:"primary",dark:""}},a),[e._v(" "+e._s(e.$vuetify.lang.t("$vuetify.baseFromDialog.save"))+" ")])],{on:a})]}},{key:"form",fn:function(){return[i("v-container",[i("m-movie-input",{model:{value:e.video,callback:function(t){e.video=t},expression:"video"}}),i("v-text-field",{attrs:{label:e.$vuetify.lang.t("$vuetify.movieUploadDialog.name.title")+"*",counter:e.nameMaxSize,rules:e.nameRules,disabled:e.video.loading,"prepend-icon":"mdi-movie",hint:e.$vuetify.lang.t("$vuetify.movieUploadDialog.name.hint"),required:""},model:{value:e.video.name,callback:function(t){e.$set(e.video,"name",t)},expression:"video.name"}}),i("v-text-field",{attrs:{label:e.$vuetify.lang.t("$vuetify.movieUploadDialog.fps.title")+"*",rules:e.fpsRules,disabled:e.video.loading,hint:e.$vuetify.lang.t("$vuetify.movieUploadDialog.fps.hint"),"prepend-icon":"mdi-movie-edit",required:""},model:{value:e.video.fps,callback:function(t){e.$set(e.video,"fps",t)},expression:"video.fps"}})],1),e.debug?i("v-container",[i("pre",[e._v(e._s(e.video))])]):e._e()]},proxy:!0}],null,!0)})},I=[],L=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-dialog",{attrs:{persistent:"","max-width":"600px"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[e._t("activator",[i("v-btn",e._g({},a),[e._v(" "+e._s(e.$vuetify.lang.t("$vuetify.baseFromDialog.open"))+" ")])],{on:a})]}}],null,!0),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[i("v-card",[i("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[e.title?i("v-card-title",[i("span",{staticClass:"headline"},[e._v(e._s(e.title))])]):e._e(),i("v-card-text",[e._t("form"),i("small",[e._v(" "+e._s(e.$vuetify.lang.t("$vuetify.baseFromDialog.hint"))+" ")])],2),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.reset}},[e._v(" "+e._s(e.$vuetify.lang.t("$vuetify.baseFromDialog.close"))+" ")]),i("v-btn",{attrs:{color:"blue darken-1",text:"",loading:e.isloading},on:{click:e.validate}},[e._v(" "+e._s(e.$vuetify.lang.t("$vuetify.baseFromDialog.save"))+" ")])],1)],1)],1)],1)},W=[],F={name:"MBaseFormDialog",props:{title:{type:String},isloading:{type:Boolean,default:function(){return!1}}},data:function(){return{valid:!0,dialog:!1}},methods:{validate:function(){var e="".concat(this.$options.name,":validate");this.valid=this.$refs.form.validate(),this.valid?(console.info(e,this.valid),this.$emit("valid"),this.dialog=!1):console.warn(e,this.valid)},reset:function(){var e="".concat(this.$options.name,":reset");console.info(e),this.$refs.form.reset(),this.dialog=!1},resetValidation:function(){var e="".concat(this.$options.name,":resetValidation");console.info(e),this.$refs.form.resetValidation()}}},D=F,z=i("b0af"),N=i("99d9"),B=i("169a"),U=i("4bd4"),q=Object(h["a"])(D,L,W,!1,null,null,null),H=q.exports;f()(q,{VBtn:m["a"],VCard:z["a"],VCardActions:N["a"],VCardText:N["b"],VCardTitle:N["c"],VDialog:B["a"],VForm:U["a"],VSpacer:g["a"]});var X=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("v-file-input",{attrs:{label:e.$vuetify.lang.t("$vuetify.movieUploadDialog.file.title")+"*",hint:e.$vuetify.lang.t("$vuetify.movieUploadDialog.file.hint"),"prepend-icon":"mdi-file-video",accept:"video/*","show-size":""},on:{change:e.onChangeFileInput},model:{value:e.video.file,callback:function(t){e.$set(e.video,"file",t)},expression:"video.file"}})],1)},G=[],Y=(i("96cf"),i("1da1")),Z=(i("4de4"),i("466d"),i("5cc6"),i("9a8c"),i("a975"),i("735e"),i("c1ac"),i("d139"),i("3a7b"),i("d5d6"),i("82f8"),i("e91f"),i("60bd"),i("5f96"),i("3280"),i("3fcc"),i("ca91"),i("25a1"),i("cd26"),i("3c5d"),i("2954"),i("649e"),i("219c"),i("170b"),i("b39a"),i("72f7"),i("b85c")),J=i("fcfb"),K=i.n(J),Q=function(e){var t="",i="",a=K()({arguments:["-version"],print:function(e){t+=e+"\n"},printErr:function(e){i+=e+"\n"},onExit:function(a){0==a?(console.info(t),e(a,t)):(console.info(i),e(a,t))}});return a},ee=function(e,t){var i=new Uint8Array(e),a="",n=K()({MEMFS:[{name:"data.mp4",data:i}],arguments:["-i","data.mp4"],print:function(e){a+=e+"\n"},printErr:function(e){a+=e+"\n"},onExit:function(){var e,i={},n=Object(Z["a"])(a.split("\n"));try{for(n.s();!(e=n.n()).done;){var r=e.value;if(~r.indexOf("Stream")){var s=r.split(": ");if(3==s.length){var o=s[2].split(", ");if("Video"==s[1]){i.videoStream={};var l=o.filter((function(e){return e.match(/x/)&&e.match(/\[/)&&e.match(/\]/)&&e.match(/ /)}))[0].split(" ")[0].split("x");i.size={width:Number(l[0]),height:Number(l[1])},i.videoStream.codec_name=o[0],i.videoStream.pix_fmt=o[1],i.videoStream.bitrate=Number(o.filter((function(e){return e.match(/kb\/s/)}))[0].split(" ")[0]),i.videoStream.fps=Number(o.filter((function(e){return e.match(/fps/)}))[0].split(" ")[0]),i.videoStream.tbr=Number(o.filter((function(e){return e.match(/tbr/)}))[0].split(" ")[0]),i.videoStream.tbn=Number(o.filter((function(e){return e.match(/tbn/)}))[0].split(" ")[0]),i.videoStream.tbc=Number(o.filter((function(e){return e.match(/tbc/)}))[0].split(" ")[0])}else i.audioStream={},i.audioStream.codec_name=o[0],i.audioStream.sample_rate=Number(o[1].split(" ")[0]),i.audioStream.channel_layout=o[2],i.audioStream.sample_fmt=o[3],i.audioStream.bitrate=Number(o[4].split(" ")[0])}}}}catch(c){n.e(c)}finally{n.f()}t(i)}});return n},te=function(e){var t="",i="",a=new Uint8Array(e),n=K()({MEMFS:[{name:"data.mp4",data:a}],arguments:["-i","data.mp4","-vcodec","mjpeg","image_%03d.jpg"],print:function(e){t+=e+"\n"},printErr:function(e){i+=e+"\n"},onExit:function(e){console.info("Process exited with code "+e),0==e?console.log(t):console.log(i)}});return n},ie={version:Q,info:ee,getFrames:te},ae=(i("c19f"),function(e){return new Promise((function(t,i){var a=new FileReader;a.readAsDataURL(e),a.onload=function(){return t(a.result)},a.onerror=function(e){return i(e)}}))}),ne=function(e){for(var t=atob(e.split(",")[1]),i=e.split(",")[0].split(":")[1].split(";")[0],a=new ArrayBuffer(t.length),n=new Uint8Array(a),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return new Blob([a],{type:i})},re=function(e){for(var t=atob(e.split(",")[1]),i=new ArrayBuffer(t.length),a=new Uint8Array(i),n=0;n<t.length;n++)a[n]=t.charCodeAt(n);return i},se=function(e){return new Promise((function(t,i){var a=new FileReader;a.readAsDataURL(e),a.onload=function(){return t(new Uint8Array(a.result))},a.onerror=function(e){return i(e)}}))},oe=function(){var e=Object(Y["a"])(regeneratorRuntime.mark((function e(t,i,a){var n,r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return n=e.sent,e.next=5,n.blob();case 5:return r=e.sent,s=new File([r],i,a),e.abrupt("return",s);case 8:case"end":return e.stop()}}),e)})));return function(t,i,a){return e.apply(this,arguments)}}(),le={toBase64:ae,toBlob:ne,toBuff:re,toUnit8Array:se,download:oe},ce={name:"MMovieInput",props:{value:{type:Object,required:!0}},data:function(){return{debug:!1}},computed:{video:{get:function(){return this.value},set:function(e){this.$emit("onChangeFileInput",e)}}},methods:{log:function(e,t){this.debug&&console.info(e,t)},initItem:function(){this.video.dataUrl=null,this.video.name=null,this.video.fps=null,this.video.size={width:null,height:null},this.video.videoStream={codec_name:null,pix_fmt:null,bitrate:null,fps:null,tbc:null,tbn:null,tbr:null},this.video.audioStream={bitrate:null,channel_layout:null,codec_name:null,sample_fmt:null,sample_rate:null}},onChangeFileInput:function(){var e=Object(Y["a"])(regeneratorRuntime.mark((function e(t){var i,a,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i="".concat(this.$options.name,":onChangeFileInput"),this.video.loading=!0,!t){e.next=18;break}if(this.video.name=t.name,!t.arrayBuffer){e.next=14;break}return e.next=7,t.arrayBuffer();case 7:return a=e.sent,ie.info(a,(function(e){n.video.size=e.size,e.videoStream&&(n.log(i+":set video",e.videoStream),n.video.fps=e.videoStream.fps?e.videoStream.fps:n.video.fps,n.video.videoStream={codec_name:e.videoStream.codec_name,pix_fmt:e.videoStream.pix_fmt,bitrate:e.videoStream.bitrate,fps:e.videoStream.fps,tbc:e.videoStream.tbc,tbn:e.videoStream.tbn,tbr:e.videoStream.tbr}),e.audioStream&&(n.log(i+":set audio",e.videoStream),n.video.audioStream={codec_name:e.audioStream.codec_name,sample_rate:e.audioStream.sample_rate,channel_layout:e.audioStream.channel_layout,sample_fmt:e.audioStream.sample_fmt,bitrate:e.audioStream.bitrate})})),e.next=11,le.toBase64(this.video.file);case 11:this.video.dataUrl=e.sent,e.next=15;break;case 14:this.initItem();case 15:this.video.loading=!1,e.next=21;break;case 18:this.initItem(),console.warn(i,"no video",this.video),this.video.loading=!1;case 21:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}},ue=ce,he=i("23a7"),de=Object(h["a"])(ue,X,G,!1,null,"b5874ce6",null),fe=de.exports;f()(de,{VFileInput:he["a"]});var ve=30,me={name:"MMovieUploadDialog",components:{MBaseFormDialog:H,MMovieInput:fe},data:function(){return{debug:!1,dialog:!1,video:{loading:!1,name:null,fps:0},nameMaxSize:ve,nameRules:null,fpsRules:null}},methods:{log:function(e,t){this.debug&&console.info(e,t)},onValid:function(){var e=this,t="".concat(this.$options.name,":onValid"),i={name:this.video.name,fileSize:this.video.file.size,fileType:this.video.file.type,fps:this.video.fps,dataUrl:this.video.dataUrl,lastModifiedDate:this.video.file.lastModifiedDate,currentTime:0,audioStream:this.video.audioStream,videoStream:this.video.videoStream,size:{width:this.video.size.width,height:this.video.size.height}};this.log(t+":inserteItem",i),$.insertOrUpdate({data:i}).then((function(){var i=$.query().last();e.log(t+":insertedItem",i),e.$refs.form.reset(),e.$router.push({name:"MovieAnnotation",params:{id:i.id}})}))}},mounted:function(){var e=this;this.fpsRules=[function(t){return!!t||e.$vuetify.lang.t("$vuetify.validate.required")},function(t){var i=/^([1-9]\d*|0)(\.\d+)?$/;return!t||(!!i.test(t)||e.$vuetify.lang.t("$vuetify.validate.isFloat"))}],this.nameRules=[function(t){return!!t||e.$vuetify.lang.t("$vuetify.validate.required")},function(t){return t&&t.length<ve||e.$vuetify.lang.t("$vuetify.validate.lessThen",ve)}]}},pe=me,ge=i("a523"),be=i("8654"),ye=Object(h["a"])(pe,V,I,!1,null,null,null),we=ye.exports;f()(ye,{VBtn:m["a"],VContainer:ge["a"],VTextField:be["a"]});var ke="vuex",xe=window.localStorage,Ce=function(){return JSON.parse(xe.getItem(ke))},_e=function(e){var t=JSON.stringify(e);return xe.setItem(ke,t),Ce()},Se=function(){return xe.removeItem(ke)},Pe={get:Ce,set:_e,destroy:Se},Ee={name:"MSideBar",components:{MMovieUploadDialog:we},data:function(){return{name:"MSideBar",debug:!0,mini:!0,menu:{icon:"mdi-playlist-play",open:!1},search:{key:"",label:"search"},current:{movie:{id:1}}}},watch:{"search.key":function(e){var t="".concat(this.$options.name,":watch:search.key");e?(this.log(t,e),this.menu.open=!0):this.menu.open=!1},mini:function(e){var t="".concat(this.$options.name,":watch:mini");this.log(t,e),!0===e&&(this.menu.open=!1)}},methods:{log:function(e,t){this.debug&&console.info(e,t)},selectFile:function(e){var t="".concat(this.$options.name,":selectFile");this.log(t,e.id),this.$router.push({name:"MovieAnnotation",params:{id:e.id}})},clearCache:function(){var e="".concat(this.$options.name);$.deleteAll(),this.$router.push({name:"Home"}),this.log(e,"clearCache")},importCache:function(){var e="".concat(this.$options.name);this.log(e,"importCache")},exportCache:function(){var e="".concat(this.$options.name,":exportCache"),t=Pe.get(),i=JSON.stringify(t),a=new Blob([i],{type:"application/json"}),n=document.createElement("a");n.href=window.URL.createObjectURL(a),n.download="Cache.json",n.click(),this.log(e,t)}},computed:{files:function(){var e,t="".concat(this.$options.name,":conputed:files:get");if(this.search.key){var i=this.search.key;e=$.query().where((function(e){if(~e.name.indexOf(i))return!0;if(~i.indexOf("fps")){var t=Number(i.split("fps")[0].trim());return e.fps>t}return!1})).get()}else e=$.query().all();return this.log(t,e),e}}},Te=Ee,je=i("ce7e"),Re=i("8860"),Me=i("56b0"),Oe=i("da13"),Ae=i("1800"),$e=i("5d23"),Ve=i("f774"),Ie=Object(h["a"])(Te,k,x,!1,null,null,null),Le=Ie.exports;f()(Ie,{VDivider:je["a"],VIcon:p["a"],VList:Re["a"],VListGroup:Me["a"],VListItem:Oe["a"],VListItemAction:Ae["a"],VListItemContent:$e["a"],VListItemSubtitle:$e["b"],VListItemTitle:$e["c"],VNavigationDrawer:Ve["a"],VSpacer:g["a"],VTextField:be["a"]});var We={name:"App",components:{MAppBar:w,MSideBar:Le},data:function(){return{}},mounted:function(){var e=navigator.language;"ja"==e?this.$vuetify.lang.current="ja":~e.indexOf("zh")?this.$vuetify.lang.current="zhHans":this.$vuetify.lang.current="en",console.log()}},Fe=We,De=i("7496"),ze=i("a75b"),Ne=Object(h["a"])(Fe,r,s,!1,null,null,null),Be=Ne.exports;f()(Ne,{VApp:De["a"],VContent:ze["a"]});var Ue=i("9483");Object(Ue["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var qe=i("8c4f"),He=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-container",{staticClass:"home"},[i("v-card",{attrs:{flat:""}},[e.$vuetify.breakpoint.smAndDown?e._e():i("div",[i("h3",{staticClass:"display-3"},[e._v(e._s(e.name)+" ver."+e._s(e.version))]),i("div",{staticClass:"subheading"},[e._v(" "+e._s(e.$vuetify.lang.t("$vuetify.home.disc"))+" ")]),i("v-divider",{staticClass:"my-3"})],1),i("div",{staticClass:"title mb-3"},[e._v(" "+e._s(e.$vuetify.lang.t("$vuetify.home.upload.title"))+" ")]),i("m-movie-upload-dialog",{scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[i("v-btn",e._g({staticClass:"mx-0",attrs:{color:"primary",dark:"",large:""}},a),[e._v(" "+e._s(e.$vuetify.lang.t("$vuetify.home.upload.btn"))+" ")])]}}])}),i("div",{staticClass:"caption py-1"},[i("v-icon",[e._v("mdi-information")]),e._v(" "+e._s(e.$vuetify.lang.t("$vuetify.home.upload.hint"))+" ")],1),i("v-divider",{staticClass:"my-3"}),i("div",{staticClass:"title mb-3"},[e._v(" "+e._s(e.$vuetify.lang.t("$vuetify.home.demo.title"))+" ")]),i("m-sample-video-botton",{staticClass:"mx-0"}),i("div",{staticClass:"caption"},[i("v-icon",[e._v("mdi-information")]),e._v(" "+e._s(e.$vuetify.lang.t("$vuetify.home.demo.hint"))+" ")],1)],1)],1)},Xe=[],Ge=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("v-btn",{attrs:{color:"primary",dark:"",large:"",loading:e.video.loading},on:{click:e.importSampleMovie}},[e._v(" "+e._s(e.$vuetify.lang.t("$vuetify.home.demo.btn"))+" ")]),e.debug?i("pre",[e._v("  "+e._s(e.item)+"\n  ")]):e._e()],1)},Ye=[],Ze={data:function(){return{debug:!1,item:{fps:13.79},video:{loading:!1}}},methods:{log:function(e,t){this.debug&&console.info(e,t)},importSampleMovie:function(){var e=Object(Y["a"])(regeneratorRuntime.mark((function e(){var t,i,a,n,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t="".concat(this.$options.name,":importSampleMovie"),this.item.name="sample.mp4",this.item.loading=!0,this.item.fileSize=1571328,this.item.fileType="video/mp4",i="https://kikuchiken-waseda.github.io/MRIVuewer/misc/6.mp4",e.next=8,le.download(i,this.item.name,{type:"video/mp4"});case 8:return a=e.sent,e.next=11,le.toBase64(a);case 11:this.item.dataUrl=e.sent,n=le.toBuff(this.item.dataUrl),ie.info(n,(function(e){r.item.size=e.size,e.videoStream&&(r.item.fps=e.videoStream.fps?e.videoStream.fps:r.item.fps,r.item.videoStream={codec_name:e.videoStream.codec_name,pix_fmt:e.videoStream.pix_fmt,bitrate:e.videoStream.bitrate,fps:e.videoStream.fps,tbc:e.videoStream.tbc,tbn:e.videoStream.tbn,tbr:e.videoStream.tbr}),e.audioStream&&(r.item.audioStream={codec_name:e.audioStream.codec_name,sample_rate:e.audioStream.sample_rate,channel_layout:e.audioStream.channel_layout,sample_fmt:e.audioStream.sample_fmt,bitrate:e.audioStream.bitrate}),r.log(t+":inserteItem",r.item),$.insertOrUpdate({data:r.item}).then((function(){var e=$.query().last();r.log(t+":insertedItem",e),r.video.loading=!1,r.$router.push({name:"MovieAnnotation",params:{id:e.id}})}))}));case 14:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},Je=Ze,Ke=Object(h["a"])(Je,Ge,Ye,!1,null,null,null),Qe=Ke.exports;f()(Ke,{VBtn:m["a"]});var et={name:"Home",components:{MMovieUploadDialog:we,MSampleVideoBotton:Qe},computed:{name:{get:function(){return this.$store.state.appName}},version:{get:function(){return this.$store.state.appVersion}}}},tt=et,it=Object(h["a"])(tt,He,Xe,!1,null,null,null),at=it.exports;f()(it,{VBtn:m["a"],VCard:z["a"],VContainer:ge["a"],VDivider:je["a"],VIcon:p["a"]});var nt=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},rt=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"about"},[i("h1",[e._v("This is an about page")])])}],st={name:"About"},ot=st,lt=Object(h["a"])(ot,nt,rt,!1,null,null,null),ct=lt.exports,ut=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},ht=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"config"},[i("h1",[e._v("This is a config page")])])}],dt={name:"Config"},ft=dt,vt=Object(h["a"])(ft,ut,ht,!1,null,null,null),mt=vt.exports,pt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-container",{directives:[{name:"resize",rawName:"v-resize",value:e.onResize,expression:"onResize"}],staticClass:"pa-0 movie-annotaion",attrs:{fluid:""}},[e.item?i("m-tool-bar",{attrs:{"file-name":e.item.name,"menu-funcs":e.menuFuncs},scopedSlots:e._u([{key:"setting",fn:function(){return[i("m-setting-menu",{attrs:{menuFuncs:e.menuFuncs}})]},proxy:!0}],null,!1,2857358650)}):e._e(),i("v-card",{attrs:{color:e.background}},[e.item?i("v-container",[i("v-row",[i("v-col",{staticClass:"flex-grow-1 flex-shrink-1"},[i("v-card",{ref:"videoCard",attrs:{flat:"",color:e.background}},[i("v-container",{staticClass:"pa-0",attrs:{fluid:""}},[i("v-row",{staticClass:"py-0"},[i("v-col",{staticClass:"py-0",attrs:{cols:"4"}},[i("v-card",{attrs:{flat:"",color:e.background}},[i("v-system-bar",{attrs:{dark:"",color:"accent"}},[e._v(" "+e._s(e.frameOffset)+"フレーム前の画像 ")]),e.item.dataUrl?i("video",{ref:"videoPre",style:e.videoStyle,attrs:{muted:"",src:e.item.dataUrl},domProps:{muted:!0}}):e._e()],1)],1),i("v-col",{staticClass:"py-0",attrs:{cols:"4"}},[i("v-card",{attrs:{flat:"",color:e.background}},[i("v-system-bar",{attrs:{dark:"",color:"accent"}},[e._v(" 現在画像 ")]),e.item.dataUrl?i("video",{ref:"video",style:e.videoStyle,attrs:{src:e.item.dataUrl}}):e._e()],1)],1),i("v-col",{staticClass:"py-0",attrs:{cols:"4"}},[i("v-card",{attrs:{flat:"",color:e.background}},[i("v-system-bar",{attrs:{dark:"",color:"accent"}},[e._v(" "+e._s(e.frameOffset)+"フレーム後の画像 ")]),e.item.dataUrl?i("video",{ref:"videoPos",style:e.videoStyle,attrs:{muted:"",src:e.item.dataUrl},domProps:{muted:!0}}):e._e()],1)],1)],1)],1),i("v-card",[i("v-card-actions",[i("v-btn",{attrs:{icon:""}},[i("v-icon",[e._v("mdi-skip-previous")])],1),i("v-btn",{attrs:{icon:""}},[i("v-icon",[e._v("mdi-skip-backward")])],1),i("v-spacer"),i("v-btn",{attrs:{fab:"",dark:"",small:"",color:"accent"},on:{click:e.play}},[i("v-icon",[e._v(" mdi-play ")])],1),i("v-btn",{attrs:{fab:"",dark:"",small:"",color:"accent"},on:{click:e.pause}},[i("v-icon",[e._v(" mdi-pause ")])],1),i("v-spacer"),i("v-btn",{attrs:{icon:""}},[i("v-icon",[e._v("mdi-skip-next")])],1),i("v-btn",{attrs:{icon:""}},[i("v-icon",[e._v("mdi-skip-forward")])],1)],1)],1)],1)],1),i("v-col",{staticClass:"flex-grow-1 flex-shrink-1 d-none d-sm-flex",attrs:{cols:"5"}},[e.tiers?i("m-tier-list",{attrs:{items:e.tiers,ws:e.ws,"max-height":e.videoHeight}}):e._e()],1)],1),e.isLoading?i("v-progress-linear",{attrs:{color:"accent",height:"10",indeterminate:""}}):e._e(),i("v-card",[i("v-card",{attrs:{id:"wave-spectrogram"}}),i("v-card",{attrs:{id:"wave-timeline"}}),i("v-text-field",{ref:"textField",attrs:{label:"Text","hide-details":"",solo:"",dense:""},on:{input:e.onChangeText,keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnterText(t)}},model:{value:e.text,callback:function(t){e.text=t},expression:"text"}}),i("v-card",{attrs:{id:"wave-multiline"}}),i("v-card",{attrs:{id:"waveform"}}),i("v-card",{attrs:{id:"wave-minimap"}})],1)],1):e._e()],1),e.debug?i("v-card",[e.item?i("v-container",[i("pre",[e._v(e._s(e.tiers))])]):e._e()],1):e._e()],1)},gt=[],bt=(i("99af"),i("7db0"),i("fcf4")),yt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-toolbar",{attrs:{dark:"",color:"secondary",dense:""}},[i("v-toolbar-title",[e._v(" "+e._s(e.fileName)+" ")]),i("v-spacer"),i("m-info-menu"),e._t("setting"),i("v-menu",{attrs:{left:"",bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[i("v-btn",e._g({attrs:{icon:""}},a),[i("v-icon",[e._v("mdi-dots-vertical")])],1)]}}])},[i("m-func-list",{attrs:{title:"メニュー",items:e.menuFuncs}})],1)],2)},wt=[],kt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-menu",{attrs:{bottom:"",left:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[i("v-btn",e._g({attrs:{icon:""}},a),[i("v-icon",[e._v(e._s(e.icon))])],1)]}}]),model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[i("v-card",{staticClass:"mx-auto"},[i("v-toolbar",{attrs:{color:"primary",dark:"",dense:""}},[i("v-toolbar-title",[e._v(" "+e._s(e.$vuetify.lang.t("$vuetify.movieAnnotation.info.title"))+" ")])],1),e.items.videoStream?i("m-info-list",{attrs:{title:"video stream",items:e.items.videoStream}}):e._e(),e.items.audioStream?i("m-info-list",{attrs:{title:"audio stream",items:e.items.audioStream}}):e._e()],1)],1)},xt=[],Ct=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-list",[e.title?i("v-subheader",[e._v(e._s(e.title))]):e._e(),e._l(e.items,(function(t,a){return i("v-list-item",{key:a,attrs:{"two-line":""}},[i("v-list-item-title",[e._v(" "+e._s(t.title)+" "),t.help?i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[i("v-icon",e._g({},a),[e._v(" mdi-information ")])]}}],null,!0)},[i("span",[e._v(e._s(t.help))])]):e._e()],1),i("v-list-item-subtitle",[e._v(" "+e._s(t.val)+" ")])],1)}))],2)},_t=[],St={props:{items:{type:Array},title:{type:String}}},Pt=St,Et=i("e0c7"),Tt=i("3a2f"),jt=Object(h["a"])(Pt,Ct,_t,!1,null,"f32d7fa0",null),Rt=jt.exports;f()(jt,{VIcon:p["a"],VList:Re["a"],VListItem:Oe["a"],VListItemSubtitle:$e["b"],VListItemTitle:$e["c"],VSubheader:Et["a"],VTooltip:Tt["a"]});var Mt={name:"movie-annotaion-m-info-menu",components:{MInfoList:Rt},data:function(){return{debug:!1,show:!1}},methods:{log:function(e,t){this.debug&&console.info(e,t)}},computed:{items:function(){var e="".concat(this.$options.name,":computed:items"),t=this.$route.params.id,i={audioStream:[],videoStream:[]};if(t){var a=$.find(t);this.log(e,a);var n=O.find(a.videoStream_id);n&&(i.videoStream=[{title:this.$vuetify.lang.t("$vuetify.movieAnnotation.info.videoStream.codec.title"),val:"".concat(n.codec_name,", ").concat(n.pix_fmt)},{title:this.$vuetify.lang.t("$vuetify.movieAnnotation.info.videoStream.bitrate.title"),val:"".concat(n.bitrate," kb/s")},{title:this.$vuetify.lang.t("$vuetify.movieAnnotation.info.videoStream.fps.title"),val:"".concat(n.fps," fps")},{title:this.$vuetify.lang.t("$vuetify.movieAnnotation.info.videoStream.tbr.title"),val:"".concat(n.tbr," tbr"),help:this.$vuetify.lang.t("$vuetify.movieAnnotation.info.videoStream.tbr.help")},{title:this.$vuetify.lang.t("$vuetify.movieAnnotation.info.videoStream.tbn.title"),val:"".concat(n.tbn," tbn"),help:this.$vuetify.lang.t("$vuetify.movieAnnotation.info.videoStream.tbn.help")},{title:this.$vuetify.lang.t("$vuetify.movieAnnotation.info.videoStream.tbc.title"),val:"".concat(n.tbc," tbc"),help:this.$vuetify.lang.t("$vuetify.movieAnnotation.info.videoStream.tbc.help")}]);var r=M.find(a.audioStream_id);this.log(e+":audioStream",r),r&&(i.audioStream=[{title:this.$vuetify.lang.t("$vuetify.movieAnnotation.info.audioStream.codec.title"),val:r.codec_name},{title:this.$vuetify.lang.t("$vuetify.movieAnnotation.info.audioStream.bitrate.title"),val:"".concat(r.bitrate," kb/s")},{title:this.$vuetify.lang.t("$vuetify.movieAnnotation.info.audioStream.channel_layout.title"),val:r.channel_layout},{title:this.$vuetify.lang.t("$vuetify.movieAnnotation.info.audioStream.sample_rate.title"),val:"".concat(r.sample_rate," Hz")}])}else this.log(e,"no id");return i}},props:{icon:{type:String,default:"mdi-help-circle"}}},Ot=Mt,At=i("e449"),$t=i("71d9"),Vt=Object(h["a"])(Ot,kt,xt,!1,null,null,null),It=Vt.exports;f()(Vt,{VBtn:m["a"],VCard:z["a"],VIcon:p["a"],VMenu:At["a"],VToolbar:$t["a"],VToolbarTitle:b["a"]});var Lt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-list",[e.title?i("v-subheader",[e._v(e._s(e.title))]):e._e(),e._l(e.items,(function(t,a){return i("v-list-item",{key:a,on:{click:t.callback}},[t.icon?i("v-list-item-icon",[i("v-icon",{domProps:{textContent:e._s(t.icon)}})],1):e._e(),i("v-list-item-content",[i("v-list-item-title",[e._v(" "+e._s(t.title)+" "),t.help?i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[i("v-icon",e._g({},a),[e._v(" mdi-information ")])]}}],null,!0)},[i("span",[e._v(e._s(t.help))])]):e._e()],1)],1)],1)}))],2)},Wt=[],Ft={props:{items:{type:Array},title:{type:String}}},Dt=Ft,zt=i("34c3"),Nt=Object(h["a"])(Dt,Lt,Wt,!1,null,"197a6350",null),Bt=Nt.exports;f()(Nt,{VIcon:p["a"],VList:Re["a"],VListItem:Oe["a"],VListItemContent:$e["a"],VListItemIcon:zt["a"],VListItemTitle:$e["c"],VSubheader:Et["a"],VTooltip:Tt["a"]});var Ut={name:"movie-annotaion-tool-bar",components:{MInfoMenu:It,MFuncList:Bt},props:{fileName:{type:String},menuFuncs:{type:Array}},methods:{onUpdateFiler:function(e){this.$emit("updateFiler",e)}}},qt=Ut,Ht=Object(h["a"])(qt,yt,wt,!1,null,"a57e322e",null),Xt=Ht.exports;f()(Ht,{VBtn:m["a"],VIcon:p["a"],VMenu:At["a"],VSpacer:g["a"],VToolbar:$t["a"],VToolbarTitle:b["a"]});var Gt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-menu",{attrs:{bottom:"","close-on-click":!1,"close-on-content-click":!1,left:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[i("v-btn",e._g({attrs:{icon:""}},a),[i("v-icon",[e._v(e._s(e.icon))])],1)]}}]),model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[i("v-card",{staticStyle:{"min-width":"600px"}},[i("v-toolbar",{attrs:{color:"primary",dark:"",dense:""}},[i("v-toolbar-title",[e._v("設定メニュー")])],1),i("m-func-list",{attrs:{title:"動画操作",items:e.funcs}}),i("v-list",{staticClass:"overflow-y-auto",staticStyle:{"min-width":"600px","max-height":"400px"}},[i("v-subheader",[e._v("イコライザー")]),e._l(e.eqs,(function(t,a){return i("v-list-item",{key:a},[i("v-list-item-content",[i("v-slider",{attrs:{min:-40,max:40,label:"f: "+t.f},model:{value:t.val,callback:function(i){e.$set(t,"val",i)},expression:"eq.val"}})],1)],1)}))],2),i("v-list",[i("v-subheader",[e._v("拡大")]),i("v-list-item-content",[i("v-slider",{attrs:{min:200,max:300},model:{value:e.zoom,callback:function(t){e.zoom=t},expression:"zoom"}})],1)],1),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{text:""},on:{click:function(t){e.show=!1}}},[e._v("Close")])],1)],1)],1)},Yt=[],Zt=(i("d81d"),{name:"movie-annotaion-m-setting-menu",components:{MFuncList:Bt},data:function(){return{show:!1,funcs:[],zoom:100,eqs:[{f:32,val:0,type:"lowshelf"},{f:64,val:0,type:"peaking"},{f:125,val:0,type:"peaking"},{f:250,val:0,type:"peaking"},{f:500,val:0,type:"peaking"},{f:1e3,val:0,type:"peaking"},{f:2e3,val:0,type:"peaking"},{f:4e3,val:0,type:"peaking"},{f:8e3,val:0,type:"peaking"},{f:16e3,val:0,type:"highshelf"}]}},props:{value:{type:Object,requested:!0},icon:{type:String,default:"mdi-cog"}},watch:{eqs:{handler:function(e){var t="".concat(this.$options.name,":watch:eqs");console.log(t,e),this.setFilters()},deep:!0},zoom:function(e){var t="".concat(this.$options.name,":zoom");console.log(t,e),this.ws.zoom(Number(e))}},methods:{setFilters:function(){var e=this;if(this.ws){var t="".concat(this.$options.name,":setFilters");console.log(t);var i=this.eqs.map((function(t){var i=e.ws.backend.ac.createBiquadFilter();return i.type=t.type,i.gain.value=~~t.val,i.Q.value=1,i.frequency.value=t.f,i}));console.log(t,i),this.$emit("updateFiler",i)}}},mounted:function(){}}),Jt=Zt,Kt=i("ba0d"),Qt=Object(h["a"])(Jt,Gt,Yt,!1,null,null,null),ei=Qt.exports;f()(Qt,{VBtn:m["a"],VCard:z["a"],VCardActions:N["a"],VIcon:p["a"],VList:Re["a"],VListItem:Oe["a"],VListItemContent:$e["a"],VMenu:At["a"],VSlider:Kt["a"],VSpacer:g["a"],VSubheader:Et["a"],VToolbar:$t["a"],VToolbarTitle:b["a"]});var ti=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-card",{staticClass:"max-auto overflow-y-auto",style:e.cardStyle,attrs:{width:"100%"}},[i("v-tabs",{attrs:{dark:"","background-color":"teal darken-3","show-arrows":""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[i("v-tabs-slider",{attrs:{color:"teal lighten-3"}}),e._l(e.items,(function(t,a){return i("v-tab",{key:a},[e._v(" "+e._s(t.name)+" ")])}))],2),i("v-tabs-items",{model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},e._l(e.items,(function(t){return i("v-tab-item",{key:t.name},[i("v-card",{attrs:{flat:""}},[i("v-simple-table",{scopedSlots:e._u([{key:"default",fn:function(){return["interval"==t.tierType?i("tbody",e._l(t.items,(function(a,n){return i("tr",{key:n},[i("td",[e._v(e._s(a.text))]),i("td",[e._v(e._s(a.time))]),n==t.items.length-1?i("td",[e._v(" "+e._s(e.ws.getDuration())+" ")]):i("td",[e._v(" "+e._s(t.items[Number(n+1)].time)+" ")])])})),0):i("tbody",e._l(t.items,(function(t,a){return i("tr",{key:a},[i("td",[e._v(e._s(t.text))]),i("td",[e._v(e._s(t.time))])])})),0)]},proxy:!0}],null,!0)})],1)],1)})),1)],1)},ii=[],ai={data:function(){return{tab:null}},props:{items:{type:Array},maxHeight:{type:Number},ws:{type:Object}},computed:{cardStyle:function(){return this.maxHeight?"max-height: ".concat(this.maxHeight,"px"):"max-height: 400px"}}},ni=ai,ri=i("1f4f"),si=i("71a3"),oi=i("c671"),li=i("fe57"),ci=i("aac8"),ui=i("9a96"),hi=Object(h["a"])(ni,ti,ii,!1,null,"620286fd",null),di=hi.exports;f()(hi,{VCard:z["a"],VSimpleTable:ri["a"],VTab:si["a"],VTabItem:oi["a"],VTabs:li["a"],VTabsItems:ci["a"],VTabsSlider:ui["a"]});i("4160"),i("a15b"),i("7039"),i("b64b"),i("159b");var fi=i("99de"),vi=i("257e"),mi=(i("a434"),function(){function e(){Object(C["a"])(this,e),this.handlers=null}return Object(_["a"])(e,[{key:"on",value:function(e,t){var i=this;this.handlers||(this.handlers={});var a=this.handlers[e];return a||(a=this.handlers[e]=[]),a.push(t),{name:e,callback:t,un:function(e,t){return i.un(e,t)}}}},{key:"un",value:function(e,t){if(this.handlers){var i,a=this.handlers[e];if(a)if(t)for(i=a.length-1;i>=0;i--)a[i]==t&&a.splice(i,1);else a.length=0}}},{key:"unAll",value:function(){this.handlers=null}},{key:"once",value:function(e,t){var i=this,a=function a(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];t.apply(i,r),setTimeout((function(){i.un(e,a)}),0)};return this.on(e,a)}},{key:"fireEvent",value:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),a=1;a<t;a++)i[a-1]=arguments[a];if(this.handlers){var n=this.handlers[e];n&&n.forEach((function(e){e.apply(void 0,i)}))}}}]),e}());function pi(e){var t=new mi,i=new XMLHttpRequest,a=!1;return i.open(e.method||"GET",e.url,!0),i.responseType=e.responseType||"json",e.xhr&&(e.xhr.requestHeaders&&e.xhr.requestHeaders.forEach((function(e){i.setRequestHeader(e.key,e.value)})),e.xhr.withCredentials&&(i.withCredentials=!0)),i.addEventListener("progress",(function(e){t.fireEvent("progress",e),e.lengthComputable&&e.loaded==e.total&&(a=!0)})),i.addEventListener("load",(function(e){a||t.fireEvent("progress",e),t.fireEvent("load",e),200==i.status||206==i.status?t.fireEvent("success",i.response,e):t.fireEvent("error",e)})),i.addEventListener("error",(function(e){return t.fireEvent("error",e)})),i.send(),t.xhr=i,t}i("25f0");function gi(e){return void 0===e&&(e="wavesurfer_"),e+Math.random().toString(32).substring(2)}function bi(e){var t=-1/0;return Object.keys(e).forEach((function(i){e[i]>t&&(t=e[i])})),t}function yi(e){var t=Number(1/0);return Object.keys(e).forEach((function(i){e[i]<t&&(t=e[i])})),t}function wi(e){console.warn("util.extend is deprecated; use Object.assign instead");for(var t=arguments.length,i=new Array(t>1?t-1:0),a=1;a<t;a++)i[a-1]=arguments[a];return i.forEach((function(t){Object.keys(t).forEach((function(i){e[i]=t[i]}))})),e}function ki(e,t){return Object.keys(t).forEach((function(i){e.style[i]!==t[i]&&(e.style[i]=t[i])})),e}var xi=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){return setTimeout(e,1e3/60)}).bind(window);function Ci(e){return function(){for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return xi((function(){return e.apply(void 0,i)}))}}var _i=i("b012"),Si=i.n(_i);function Pi(e){e.stopPropagation(),document.body.removeEventListener("click",Pi,!0)}function Ei(e){document.body.addEventListener("click",Pi,!0)}var Ti=function(){function e(t,i,a){Object(C["a"])(this,e),this.instance=t,this.instance._reader=a.body.getReader(),this.total=parseInt(i,10),this.loaded=0}return Object(_["a"])(e,[{key:"start",value:function(e){var t=this,i=function i(){t.instance._reader.read().then((function(a){var n=a.done,r=a.value;if(n)return 0===t.total&&t.instance.onProgress.call(t.instance,{loaded:t.loaded,total:t.total,lengthComputable:!1}),void e.close();t.loaded+=r.byteLength,t.instance.onProgress.call(t.instance,{loaded:t.loaded,total:t.total,lengthComputable:!(0===t.total)}),e.enqueue(r),i()})).catch((function(t){e.error(t)}))};i()}}]),e}();function ji(e){if(!e)throw new Error("fetch options missing");if(!e.url)throw new Error("fetch url missing");var t=new mi,i=new Headers,a=new Request(e.url);t.controller=new AbortController,e&&e.requestHeaders&&e.requestHeaders.forEach((function(e){i.append(e.key,e.value)}));var n=e.responseType||"json",r={method:e.method||"GET",headers:i,mode:e.mode||"cors",credentials:e.credentials||"same-origin",cache:e.cache||"default",redirect:e.redirect||"follow",referrer:e.referrer||"client",signal:t.controller.signal};return fetch(a,r).then((function(e){t.response=e;var i=!0;e.body||(i=!1);var a=e.headers.get("content-length");return null===a&&(i=!1),i?(t.onProgress=function(e){t.fireEvent("progress",e)},new Response(new ReadableStream(new Ti(t,a,e)),r)):e})).then((function(e){var t;if(e.ok)switch(n){case"arraybuffer":return e.arrayBuffer();case"json":return e.json();case"blob":return e.blob();case"text":return e.text();default:t="Unknown responseType: "+n;break}throw t||(t="HTTP error status: "+e.status),new Error(t)})).then((function(e){t.fireEvent("success",e)})).catch((function(e){t.fireEvent("error",e)})),t.fetchRequest=a,t}i("45fc");var Ri=function(e){Object(S["a"])(i,e);var t=Object(P["a"])(i);function i(e,a){var n;return Object(C["a"])(this,i),n=t.call(this),n.container=e,n.params=a,n.width=0,n.height=a.height*n.params.pixelRatio,n.lastPos=0,n.wrapper=null,n}return Object(_["a"])(i,[{key:"style",value:function(e,t){return ki(e,t)}},{key:"createWrapper",value:function(){this.wrapper=this.container.appendChild(document.createElement("wave")),this.style(this.wrapper,{display:"block",position:"relative",userSelect:"none",webkitUserSelect:"none",height:this.params.height+"px"}),(this.params.fillParent||this.params.scrollParent)&&this.style(this.wrapper,{width:"100%",overflowX:this.params.hideScrollbar?"hidden":"auto",overflowY:"hidden"}),this.setupWrapperEvents()}},{key:"handleEvent",value:function(e,t){!t&&e.preventDefault();var i,a=e.targetTouches?e.targetTouches[0].clientX:e.clientX,n=this.wrapper.getBoundingClientRect(),r=this.width,s=this.getWidth();return!this.params.fillParent&&r<s?(i=(this.params.rtl?n.right-a:a-n.left)*(this.params.pixelRatio/r)||0,i>1&&(i=1)):i=((this.params.rtl?n.right-a:a-n.left)+this.wrapper.scrollLeft)/this.wrapper.scrollWidth||0,i}},{key:"setupWrapperEvents",value:function(){var e=this;this.wrapper.addEventListener("click",(function(t){var i=e.wrapper.offsetHeight-e.wrapper.clientHeight;if(0!==i){var a=e.wrapper.getBoundingClientRect();if(t.clientY>=a.bottom-i)return}e.params.interact&&e.fireEvent("click",t,e.handleEvent(t))})),this.wrapper.addEventListener("dblclick",(function(t){e.params.interact&&e.fireEvent("dblclick",t,e.handleEvent(t))})),this.wrapper.addEventListener("scroll",(function(t){return e.fireEvent("scroll",t)}))}},{key:"drawPeaks",value:function(e,t,i,a){this.setWidth(t)||this.clearWave(),this.params.barWidth?this.drawBars(e,0,i,a):this.drawWave(e,0,i,a)}},{key:"resetScroll",value:function(){null!==this.wrapper&&(this.wrapper.scrollLeft=0)}},{key:"recenter",value:function(e){var t=this.wrapper.scrollWidth*e;this.recenterOnPosition(t,!0)}},{key:"recenterOnPosition",value:function(e,t){var i=this.wrapper.scrollLeft,a=~~(this.wrapper.clientWidth/2),n=this.wrapper.scrollWidth-this.wrapper.clientWidth,r=e-a,s=r-i;if(0!=n){if(!t&&-a<=s&&s<a){var o=this.params.autoCenterRate;o/=a,o*=n,s=Math.max(-o,Math.min(o,s)),r=i+s}r=Math.max(0,Math.min(n,r)),r!=i&&(this.wrapper.scrollLeft=r)}}},{key:"getScrollX",value:function(){var e=0;if(this.wrapper){var t=this.params.pixelRatio;if(e=Math.round(this.wrapper.scrollLeft*t),this.params.scrollParent){var i=~~(this.wrapper.scrollWidth*t-this.getWidth());e=Math.min(i,Math.max(0,e))}}return e}},{key:"getWidth",value:function(){return Math.round(this.container.clientWidth*this.params.pixelRatio)}},{key:"setWidth",value:function(e){return this.width!=e&&(this.width=e,this.params.fillParent||this.params.scrollParent?this.style(this.wrapper,{width:""}):this.style(this.wrapper,{width:~~(this.width/this.params.pixelRatio)+"px"}),this.updateSize(),!0)}},{key:"setHeight",value:function(e){return e!=this.height&&(this.height=e,this.style(this.wrapper,{height:~~(this.height/this.params.pixelRatio)+"px"}),this.updateSize(),!0)}},{key:"progress",value:function(e){var t=1/this.params.pixelRatio,i=Math.round(e*this.width)*t;if(i<this.lastPos||i-this.lastPos>=t){if(this.lastPos=i,this.params.scrollParent&&this.params.autoCenter){var a=~~(this.wrapper.scrollWidth*e);this.recenterOnPosition(a,this.params.autoCenterImmediately)}this.updateProgress(i)}}},{key:"destroy",value:function(){this.unAll(),this.wrapper&&(this.wrapper.parentNode==this.container&&this.container.removeChild(this.wrapper),this.wrapper=null)}},{key:"updateCursor",value:function(){}},{key:"updateSize",value:function(){}},{key:"drawBars",value:function(e,t,i,a){}},{key:"drawWave",value:function(e,t,i,a){}},{key:"clearWave",value:function(){}},{key:"updateProgress",value:function(e){}}]),i}(mi),Mi=(i("cb29"),function(){function e(){Object(C["a"])(this,e),this.wave=null,this.waveCtx=null,this.progress=null,this.progressCtx=null,this.start=0,this.end=1,this.id=gi("undefined"!==typeof this.constructor.name?this.constructor.name.toLowerCase()+"_":"canvasentry_"),this.canvasContextAttributes={}}return Object(_["a"])(e,[{key:"initWave",value:function(e){this.wave=e,this.waveCtx=this.wave.getContext("2d",this.canvasContextAttributes)}},{key:"initProgress",value:function(e){this.progress=e,this.progressCtx=this.progress.getContext("2d",this.canvasContextAttributes)}},{key:"updateDimensions",value:function(e,t,i,a){this.start=this.wave.offsetLeft/t||0,this.end=this.start+e/t,this.wave.width=i,this.wave.height=a;var n={width:e+"px"};ki(this.wave,n),this.hasProgressCanvas&&(this.progress.width=i,this.progress.height=a,ki(this.progress,n))}},{key:"clearWave",value:function(){this.waveCtx.clearRect(0,0,this.waveCtx.canvas.width,this.waveCtx.canvas.height),this.hasProgressCanvas&&this.progressCtx.clearRect(0,0,this.progressCtx.canvas.width,this.progressCtx.canvas.height)}},{key:"setFillStyles",value:function(e,t){this.waveCtx.fillStyle=e,this.hasProgressCanvas&&(this.progressCtx.fillStyle=t)}},{key:"fillRects",value:function(e,t,i,a,n){this.fillRectToContext(this.waveCtx,e,t,i,a,n),this.hasProgressCanvas&&this.fillRectToContext(this.progressCtx,e,t,i,a,n)}},{key:"fillRectToContext",value:function(e,t,i,a,n,r){e&&(r?this.drawRoundedRect(e,t,i,a,n,r):e.fillRect(t,i,a,n))}},{key:"drawRoundedRect",value:function(e,t,i,a,n,r){0!==n&&(n<0&&(n*=-1,i-=n),e.beginPath(),e.moveTo(t+r,i),e.lineTo(t+a-r,i),e.quadraticCurveTo(t+a,i,t+a,i+r),e.lineTo(t+a,i+n-r),e.quadraticCurveTo(t+a,i+n,t+a-r,i+n),e.lineTo(t+r,i+n),e.quadraticCurveTo(t,i+n,t,i+n-r),e.lineTo(t,i+r),e.quadraticCurveTo(t,i,t+r,i),e.closePath(),e.fill())}},{key:"drawLines",value:function(e,t,i,a,n,r){this.drawLineToContext(this.waveCtx,e,t,i,a,n,r),this.hasProgressCanvas&&this.drawLineToContext(this.progressCtx,e,t,i,a,n,r)}},{key:"drawLineToContext",value:function(e,t,i,a,n,r,s){if(e){var o,l,c,u=t.length/2,h=Math.round(u*this.start),d=Math.round(u*this.end)+1,f=h,v=d,m=this.wave.width/(v-f-1),p=a+n,g=i/a;for(e.beginPath(),e.moveTo((f-h)*m,p),e.lineTo((f-h)*m,p-Math.round((t[2*f]||0)/g)),o=f;o<v;o++)l=t[2*o]||0,c=Math.round(l/g),e.lineTo((o-h)*m+this.halfPixel,p-c);var b=v-1;for(b;b>=f;b--)l=t[2*b+1]||0,c=Math.round(l/g),e.lineTo((b-h)*m+this.halfPixel,p-c);e.lineTo((f-h)*m,p-Math.round((t[2*f+1]||0)/g)),e.closePath(),e.fill()}}},{key:"destroy",value:function(){this.waveCtx=null,this.wave=null,this.progressCtx=null,this.progress=null}},{key:"getImage",value:function(e,t,i){var a=this;return"blob"===i?new Promise((function(i){a.wave.toBlob(i,e,t)})):"dataURL"===i?this.wave.toDataURL(e,t):void 0}}]),e}()),Oi=function(e){Object(S["a"])(i,e);var t=Object(P["a"])(i);function i(e,a){var n;return Object(C["a"])(this,i),n=t.call(this,e,a),n.maxCanvasWidth=a.maxCanvasWidth,n.maxCanvasElementWidth=Math.round(a.maxCanvasWidth/a.pixelRatio),n.hasProgressCanvas=a.waveColor!=a.progressColor,n.halfPixel=.5/a.pixelRatio,n.canvases=[],n.progressWave=null,n.EntryClass=Mi,n.canvasContextAttributes=a.drawingContextAttributes,n.overlap=2*Math.ceil(a.pixelRatio/2),n.barRadius=a.barRadius||0,n}return Object(_["a"])(i,[{key:"init",value:function(){this.createWrapper(),this.createElements()}},{key:"createElements",value:function(){this.progressWave=this.wrapper.appendChild(this.style(document.createElement("wave"),{position:"absolute",zIndex:3,left:0,top:0,bottom:0,overflow:"hidden",width:"0",display:"none",boxSizing:"border-box",borderRightStyle:"solid",pointerEvents:"none"})),this.addCanvas(),this.updateCursor()}},{key:"updateCursor",value:function(){this.style(this.progressWave,{borderRightWidth:this.params.cursorWidth+"px",borderRightColor:this.params.cursorColor})}},{key:"updateSize",value:function(){var e=this,t=Math.round(this.width/this.params.pixelRatio),i=Math.ceil(t/(this.maxCanvasElementWidth+this.overlap));while(this.canvases.length<i)this.addCanvas();while(this.canvases.length>i)this.removeCanvas();var a=this.maxCanvasWidth+this.overlap,n=this.canvases.length-1;this.canvases.forEach((function(t,i){i==n&&(a=e.width-e.maxCanvasWidth*n),e.updateDimensions(t,a,e.height),t.clearWave()}))}},{key:"addCanvas",value:function(){var e=new this.EntryClass;e.canvasContextAttributes=this.canvasContextAttributes,e.hasProgressCanvas=this.hasProgressCanvas,e.halfPixel=this.halfPixel;var t=this.maxCanvasElementWidth*this.canvases.length;e.initWave(this.wrapper.appendChild(this.style(document.createElement("canvas"),{position:"absolute",zIndex:2,left:t+"px",top:0,bottom:0,height:"100%",pointerEvents:"none"}))),this.hasProgressCanvas&&e.initProgress(this.progressWave.appendChild(this.style(document.createElement("canvas"),{position:"absolute",left:t+"px",top:0,bottom:0,height:"100%"}))),this.canvases.push(e)}},{key:"removeCanvas",value:function(){var e=this.canvases[this.canvases.length-1];e.wave.parentElement.removeChild(e.wave),this.hasProgressCanvas&&e.progress.parentElement.removeChild(e.progress),e&&(e.destroy(),e=null),this.canvases.pop()}},{key:"updateDimensions",value:function(e,t,i){var a=Math.round(t/this.params.pixelRatio),n=Math.round(this.width/this.params.pixelRatio);e.updateDimensions(a,n,t,i),this.style(this.progressWave,{display:"block"})}},{key:"clearWave",value:function(){var e=this;Ci((function(){e.canvases.forEach((function(e){return e.clearWave()}))}))()}},{key:"drawBars",value:function(e,t,i,a){var n=this;return this.prepareDraw(e,t,i,a,(function(e){var t=e.absmax,r=e.hasMinVals,s=(e.height,e.offsetY),o=e.halfH,l=e.peaks;if(void 0!==i){var c=r?2:1,u=l.length/c,h=n.params.barWidth*n.params.pixelRatio,d=null===n.params.barGap?Math.max(n.params.pixelRatio,~~(h/2)):Math.max(n.params.pixelRatio,n.params.barGap*n.params.pixelRatio),f=h+d,v=u/n.width,m=i,p=a,g=m;for(g;g<p;g+=f){var b=l[Math.floor(g*v*c)]||0,y=Math.round(b/t*o);0==y&&n.params.barMinHeight&&(y=n.params.barMinHeight),n.fillRect(g+n.halfPixel,o-y+s,h+n.halfPixel,2*y,n.barRadius)}}}))}},{key:"drawWave",value:function(e,t,i,a){var n=this;return this.prepareDraw(e,t,i,a,(function(e){var t=e.absmax,r=e.hasMinVals,s=(e.height,e.offsetY),o=e.halfH,l=e.peaks;if(!r){var c=[],u=l.length,h=0;for(h;h<u;h++)c[2*h]=l[h],c[2*h+1]=-l[h];l=c}void 0!==i&&n.drawLine(l,t,o,s,i,a),n.fillRect(0,o+s-n.halfPixel,n.width,n.halfPixel,n.barRadius)}))}},{key:"drawLine",value:function(e,t,i,a,n,r){var s=this;this.canvases.forEach((function(o){s.setFillStyles(o),o.drawLines(e,t,i,a,n,r)}))}},{key:"fillRect",value:function(e,t,i,a,n){var r=Math.floor(e/this.maxCanvasWidth),s=Math.min(Math.ceil((e+i)/this.maxCanvasWidth)+1,this.canvases.length),o=r;for(o;o<s;o++){var l=this.canvases[o],c=o*this.maxCanvasWidth,u={x1:Math.max(e,o*this.maxCanvasWidth),y1:t,x2:Math.min(e+i,o*this.maxCanvasWidth+l.wave.width),y2:t+a};u.x1<u.x2&&(this.setFillStyles(l),l.fillRects(u.x1-c,u.y1,u.x2-u.x1,u.y2-u.y1,n))}}},{key:"prepareDraw",value:function(e,t,i,a,n){var r=this;return Ci((function(){if(e[0]instanceof Array){var s=e;if(r.params.splitChannels)return r.setHeight(s.length*r.params.height*r.params.pixelRatio),s.forEach((function(e,t){return r.prepareDraw(e,t,i,a,n)}));e=s[0]}var o=1/r.params.barHeight;if(r.params.normalize){var l=bi(e),c=yi(e);o=-c>l?-c:l}var u=[].some.call(e,(function(e){return e<0})),h=r.params.height*r.params.pixelRatio,d=h*t||0,f=h/2;return n({absmax:o,hasMinVals:u,height:h,offsetY:d,halfH:f,peaks:e})}))()}},{key:"setFillStyles",value:function(e){e.setFillStyles(this.params.waveColor,this.params.progressColor)}},{key:"getImage",value:function(e,t,i){if("blob"===i)return Promise.all(this.canvases.map((function(a){return a.getImage(e,t,i)})));if("dataURL"===i){var a=this.canvases.map((function(a){return a.getImage(e,t,i)}));return a.length>1?a:a[0]}}},{key:"updateProgress",value:function(e){this.style(this.progressWave,{width:e+"px"})}}]),i}(Ri),Ai=(i("13d5"),"playing"),$i="paused",Vi="finished",Ii=function(e){Object(S["a"])(i,e);var t=Object(P["a"])(i);function i(e){var a,n,r;return Object(C["a"])(this,i),r=t.call(this),Object(E["a"])(Object(vi["a"])(r),"audioContext",null),Object(E["a"])(Object(vi["a"])(r),"offlineAudioContext",null),Object(E["a"])(Object(vi["a"])(r),"stateBehaviors",(a={},Object(E["a"])(a,Ai,{init:function(){this.addOnAudioProcess()},getPlayedPercents:function(){var e=this.getDuration();return this.getCurrentTime()/e||0},getCurrentTime:function(){return this.startPosition+this.getPlayedTime()}}),Object(E["a"])(a,$i,{init:function(){this.removeOnAudioProcess()},getPlayedPercents:function(){var e=this.getDuration();return this.getCurrentTime()/e||0},getCurrentTime:function(){return this.startPosition}}),Object(E["a"])(a,Vi,{init:function(){this.removeOnAudioProcess(),this.fireEvent("finish")},getPlayedPercents:function(){return 1},getCurrentTime:function(){return this.getDuration()}}),a)),r.params=e,r.ac=e.audioContext||(r.supportsWebAudio()?r.getAudioContext():{}),r.lastPlay=r.ac.currentTime,r.startPosition=0,r.scheduledPause=null,r.states=(n={},Object(E["a"])(n,Ai,Object.create(r.stateBehaviors[Ai])),Object(E["a"])(n,$i,Object.create(r.stateBehaviors[$i])),Object(E["a"])(n,Vi,Object.create(r.stateBehaviors[Vi])),n),r.buffer=null,r.filters=[],r.gainNode=null,r.mergedPeaks=null,r.offlineAc=null,r.peaks=null,r.playbackRate=1,r.analyser=null,r.scriptNode=null,r.source=null,r.splitPeaks=[],r.state=null,r.explicitDuration=e.duration,r.destroyed=!1,r}return Object(_["a"])(i,[{key:"supportsWebAudio",value:function(){return!(!window.AudioContext&&!window.webkitAudioContext)}},{key:"getAudioContext",value:function(){return window.WaveSurferAudioContext||(window.WaveSurferAudioContext=new(window.AudioContext||window.webkitAudioContext)),window.WaveSurferAudioContext}},{key:"getOfflineAudioContext",value:function(e){return window.WaveSurferOfflineAudioContext||(window.WaveSurferOfflineAudioContext=new(window.OfflineAudioContext||window.webkitOfflineAudioContext)(1,2,e)),window.WaveSurferOfflineAudioContext}}]),Object(_["a"])(i,[{key:"init",value:function(){this.createVolumeNode(),this.createScriptNode(),this.createAnalyserNode(),this.setState($i),this.setPlaybackRate(this.params.audioRate),this.setLength(0)}},{key:"disconnectFilters",value:function(){this.filters&&(this.filters.forEach((function(e){e&&e.disconnect()})),this.filters=null,this.analyser.connect(this.gainNode))}},{key:"setState",value:function(e){this.state!==this.states[e]&&(this.state=this.states[e],this.state.init.call(this))}},{key:"setFilter",value:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.setFilters(t)}},{key:"setFilters",value:function(e){this.disconnectFilters(),e&&e.length&&(this.filters=e,this.analyser.disconnect(),e.reduce((function(e,t){return e.connect(t),t}),this.analyser).connect(this.gainNode))}},{key:"createScriptNode",value:function(){this.params.audioScriptProcessor?this.scriptNode=this.params.audioScriptProcessor:this.ac.createScriptProcessor?this.scriptNode=this.ac.createScriptProcessor(i.scriptBufferSize):this.scriptNode=this.ac.createJavaScriptNode(i.scriptBufferSize),this.scriptNode.connect(this.ac.destination)}},{key:"addOnAudioProcess",value:function(){var e=this;this.scriptNode.onaudioprocess=function(){var t=e.getCurrentTime();t>=e.getDuration()?(e.setState(Vi),e.fireEvent("pause")):t>=e.scheduledPause?e.pause():e.state===e.states[Ai]&&e.fireEvent("audioprocess",t)}}},{key:"removeOnAudioProcess",value:function(){this.scriptNode.onaudioprocess=function(){}}},{key:"createAnalyserNode",value:function(){this.analyser=this.ac.createAnalyser(),this.analyser.connect(this.gainNode)}},{key:"createVolumeNode",value:function(){this.ac.createGain?this.gainNode=this.ac.createGain():this.gainNode=this.ac.createGainNode(),this.gainNode.connect(this.ac.destination)}},{key:"setSinkId",value:function(e){if(e){var t=new window.Audio;if(!t.setSinkId)return Promise.reject(new Error("setSinkId is not supported in your browser"));t.autoplay=!0;var i=this.ac.createMediaStreamDestination();return this.gainNode.disconnect(),this.gainNode.connect(i),t.srcObject=i.stream,t.setSinkId(e)}return Promise.reject(new Error("Invalid deviceId: "+e))}},{key:"setVolume",value:function(e){this.gainNode.gain.setValueAtTime(e,this.ac.currentTime)}},{key:"getVolume",value:function(){return this.gainNode.gain.value}},{key:"decodeArrayBuffer",value:function(e,t,i){this.offlineAc||(this.offlineAc=this.getOfflineAudioContext(this.ac&&this.ac.sampleRate?this.ac.sampleRate:44100)),this.offlineAc.decodeAudioData(e,(function(e){return t(e)}),i)}},{key:"setPeaks",value:function(e,t){null!=t&&(this.explicitDuration=t),this.peaks=e}},{key:"setLength",value:function(e){if(!this.mergedPeaks||e!=2*this.mergedPeaks.length-1+2){this.splitPeaks=[],this.mergedPeaks=[];var t,i=this.buffer?this.buffer.numberOfChannels:1;for(t=0;t<i;t++)this.splitPeaks[t]=[],this.splitPeaks[t][2*(e-1)]=0,this.splitPeaks[t][2*(e-1)+1]=0;this.mergedPeaks[2*(e-1)]=0,this.mergedPeaks[2*(e-1)+1]=0}}},{key:"getPeaks",value:function(e,t,i){if(this.peaks)return this.peaks;if(!this.buffer)return[];if(t=t||0,i=i||e-1,this.setLength(e),!this.buffer)return this.params.splitChannels?this.splitPeaks:this.mergedPeaks;if(!this.buffer.length){var a=this.createBuffer(1,4096,this.sampleRate);this.buffer=a.buffer}var n,r=this.buffer.length/e,s=~~(r/10)||1,o=this.buffer.numberOfChannels;for(n=0;n<o;n++){var l=this.splitPeaks[n],c=this.buffer.getChannelData(n),u=void 0;for(u=t;u<=i;u++){var h=~~(u*r),d=~~(h+r),f=0,v=0,m=void 0;for(m=h;m<d;m+=s){var p=c[m];p>v&&(v=p),p<f&&(f=p)}l[2*u]=v,l[2*u+1]=f,(0==n||v>this.mergedPeaks[2*u])&&(this.mergedPeaks[2*u]=v),(0==n||f<this.mergedPeaks[2*u+1])&&(this.mergedPeaks[2*u+1]=f)}}return this.params.splitChannels?this.splitPeaks:this.mergedPeaks}},{key:"getPlayedPercents",value:function(){return this.state.getPlayedPercents.call(this)}},{key:"disconnectSource",value:function(){this.source&&this.source.disconnect()}},{key:"destroyWebAudio",value:function(){this.disconnectFilters(),this.disconnectSource(),this.gainNode.disconnect(),this.scriptNode.disconnect(),this.analyser.disconnect(),this.params.closeAudioContext&&("function"===typeof this.ac.close&&"closed"!=this.ac.state&&this.ac.close(),this.ac=null,this.params.audioContext?this.params.audioContext=null:window.WaveSurferAudioContext=null,window.WaveSurferOfflineAudioContext=null)}},{key:"destroy",value:function(){this.isPaused()||this.pause(),this.unAll(),this.buffer=null,this.destroyed=!0,this.destroyWebAudio()}},{key:"load",value:function(e){this.startPosition=0,this.lastPlay=this.ac.currentTime,this.buffer=e,this.createSource()}},{key:"createSource",value:function(){this.disconnectSource(),this.source=this.ac.createBufferSource(),this.source.start=this.source.start||this.source.noteGrainOn,this.source.stop=this.source.stop||this.source.noteOff,this.source.playbackRate.setValueAtTime(this.playbackRate,this.ac.currentTime),this.source.buffer=this.buffer,this.source.connect(this.analyser)}},{key:"isPaused",value:function(){return this.state!==this.states[Ai]}},{key:"getDuration",value:function(){return this.explicitDuration?this.explicitDuration:this.buffer?this.buffer.duration:0}},{key:"seekTo",value:function(e,t){if(this.buffer)return this.scheduledPause=null,null==e&&(e=this.getCurrentTime(),e>=this.getDuration()&&(e=0)),null==t&&(t=this.getDuration()),this.startPosition=e,this.lastPlay=this.ac.currentTime,this.state===this.states[Vi]&&this.setState($i),{start:e,end:t}}},{key:"getPlayedTime",value:function(){return(this.ac.currentTime-this.lastPlay)*this.playbackRate}},{key:"play",value:function(e,t){if(this.buffer){this.createSource();var i=this.seekTo(e,t);e=i.start,t=i.end,this.scheduledPause=t,this.source.start(0,e),"suspended"==this.ac.state&&this.ac.resume&&this.ac.resume(),this.setState(Ai),this.fireEvent("play")}}},{key:"pause",value:function(){this.scheduledPause=null,this.startPosition+=this.getPlayedTime(),this.source&&this.source.stop(0),this.setState($i),this.fireEvent("pause")}},{key:"getCurrentTime",value:function(){return this.state.getCurrentTime.call(this)}},{key:"getPlaybackRate",value:function(){return this.playbackRate}},{key:"setPlaybackRate",value:function(e){e=e||1,this.isPaused()?this.playbackRate=e:(this.pause(),this.playbackRate=e,this.play())}},{key:"setPlayEnd",value:function(e){this.scheduledPause=e}}]),i}(mi);Object(E["a"])(Ii,"scriptBufferSize",256);var Li=i("7e84"),Wi=i("45eb"),Fi=function(e){Object(S["a"])(i,e);var t=Object(P["a"])(i);function i(e){var a;return Object(C["a"])(this,i),a=t.call(this,e),a.params=e,a.media={currentTime:0,duration:0,paused:!0,playbackRate:1,play:function(){},pause:function(){},volume:0},a.mediaType=e.mediaType.toLowerCase(),a.elementPosition=e.elementPosition,a.peaks=null,a.playbackRate=1,a.volume=1,a.isMuted=!1,a.buffer=null,a.onPlayEnd=null,a.mediaListeners={},a}return Object(_["a"])(i,[{key:"init",value:function(){this.createVolumeNode(),this.createScriptNode(),this.createAnalyserNode(),this.setPlaybackRate(this.params.audioRate),this.createTimer()}},{key:"_setupMediaListeners",value:function(){var e=this;this.mediaListeners.error=function(){e.fireEvent("error","Error loading media element")},this.mediaListeners.canplay=function(){e.fireEvent("canplay")},this.mediaListeners.ended=function(){e.fireEvent("finish")},this.mediaListeners.play=function(){e.fireEvent("play")},this.mediaListeners.pause=function(){e.fireEvent("pause")},this.mediaListeners.seeked=function(t){e.fireEvent("seek")},this.mediaListeners.volumechange=function(t){e.isMuted=e.media.muted,e.isMuted?e.volume=0:e.volume=e.media.volume,e.fireEvent("volume")},Object.keys(this.mediaListeners).forEach((function(t){e.media.removeEventListener(t,e.mediaListeners[t]),e.media.addEventListener(t,e.mediaListeners[t])}))}},{key:"createTimer",value:function(){var e=this,t=function t(){e.isPaused()||(e.fireEvent("audioprocess",e.getCurrentTime()),Ci(t)())};this.on("play",t),this.on("pause",(function(){e.fireEvent("audioprocess",e.getCurrentTime())}))}},{key:"load",value:function(e,t,i,a){var n=document.createElement(this.mediaType);n.controls=this.params.mediaControls,n.autoplay=this.params.autoplay||!1,n.preload=null==a?"auto":a,n.src=e,n.style.width="100%";var r=t.querySelector(this.mediaType);r&&t.removeChild(r),t.appendChild(n),this._load(n,i)}},{key:"loadElt",value:function(e,t){e.controls=this.params.mediaControls,e.autoplay=this.params.autoplay||!1,this._load(e,t)}},{key:"_load",value:function(e,t){if(!(e instanceof HTMLMediaElement)||"undefined"===typeof e.addEventListener)throw new Error("media parameter is not a valid media element");"function"==typeof e.load&&e.load(),this.media=e,this._setupMediaListeners(),this.peaks=t,this.onPlayEnd=null,this.buffer=null,this.isMuted=e.muted,this.setPlaybackRate(this.playbackRate),this.setVolume(this.volume)}},{key:"isPaused",value:function(){return!this.media||this.media.paused}},{key:"getDuration",value:function(){if(this.explicitDuration)return this.explicitDuration;var e=(this.buffer||this.media).duration;return e>=1/0&&(e=this.media.seekable.end(0)),e}},{key:"getCurrentTime",value:function(){return this.media&&this.media.currentTime}},{key:"getPlayedPercents",value:function(){return this.getCurrentTime()/this.getDuration()||0}},{key:"getPlaybackRate",value:function(){return this.playbackRate||this.media.playbackRate}},{key:"setPlaybackRate",value:function(e){this.playbackRate=e||1,this.media.playbackRate=this.playbackRate}},{key:"seekTo",value:function(e){null!=e&&(this.media.currentTime=e),this.clearPlayEnd()}},{key:"play",value:function(e,t){this.seekTo(e);var i=this.media.play();return t&&this.setPlayEnd(t),i}},{key:"pause",value:function(){var e;return this.media&&(e=this.media.pause()),this.clearPlayEnd(),e}},{key:"setPlayEnd",value:function(e){var t=this;this.clearPlayEnd(),this._onPlayEnd=function(i){i>=e&&(t.pause(),t.seekTo(e))},this.on("audioprocess",this._onPlayEnd)}},{key:"clearPlayEnd",value:function(){this._onPlayEnd&&(this.un("audioprocess",this._onPlayEnd),this._onPlayEnd=null)}},{key:"getPeaks",value:function(e,t,a){return this.buffer?Object(Wi["a"])(Object(Li["a"])(i.prototype),"getPeaks",this).call(this,e,t,a):this.peaks||[]}},{key:"setSinkId",value:function(e){return e?this.media.setSinkId?this.media.setSinkId(e):Promise.reject(new Error("setSinkId is not supported in your browser")):Promise.reject(new Error("Invalid deviceId: "+e))}},{key:"getVolume",value:function(){return this.volume}},{key:"setVolume",value:function(e){this.volume=e,this.media.volume!==this.volume&&(this.media.volume=this.volume)}},{key:"destroy",value:function(){var e=this;this.pause(),this.unAll(),this.destroyed=!0,Object.keys(this.mediaListeners).forEach((function(t){e.media&&e.media.removeEventListener(t,e.mediaListeners[t])})),this.params.removeMediaElementOnDestroy&&this.media&&this.media.parentNode&&this.media.parentNode.removeChild(this.media),this.media=null}}]),i}(Ii),Di=function(){function e(){Object(C["a"])(this,e),this.clearPeakCache()}return Object(_["a"])(e,[{key:"clearPeakCache",value:function(){this.peakCacheRanges=[],this.peakCacheLength=-1}},{key:"addRangeToPeakCache",value:function(e,t,i){e!=this.peakCacheLength&&(this.clearPeakCache(),this.peakCacheLength=e);var a=[],n=0;while(n<this.peakCacheRanges.length&&this.peakCacheRanges[n]<t)n++;n%2==0&&a.push(t);while(n<this.peakCacheRanges.length&&this.peakCacheRanges[n]<=i)a.push(this.peakCacheRanges[n]),n++;n%2==0&&a.push(i),a=a.filter((function(e,t,i){return 0==t?e!=i[t+1]:t==i.length-1?e!=i[t-1]:e!=i[t-1]&&e!=i[t+1]})),this.peakCacheRanges=this.peakCacheRanges.concat(a),this.peakCacheRanges=this.peakCacheRanges.sort((function(e,t){return e-t})).filter((function(e,t,i){return 0==t?e!=i[t+1]:t==i.length-1?e!=i[t-1]:e!=i[t-1]&&e!=i[t+1]}));var r=[];for(n=0;n<a.length;n+=2)r.push([a[n],a[n+1]]);return r}},{key:"getCacheRanges",value:function(){var e,t=[];for(e=0;e<this.peakCacheRanges.length;e+=2)t.push([this.peakCacheRanges[e],this.peakCacheRanges[e+1]]);return t}}]),e}(),zi=function(e){Object(S["a"])(i,e);var t=Object(P["a"])(i);function i(e){var a;return Object(C["a"])(this,i),a=t.call(this,e),a.params=e,a.sourceMediaElement=null,a}return Object(_["a"])(i,[{key:"init",value:function(){this.setPlaybackRate(this.params.audioRate),this.createTimer(),this.createVolumeNode(),this.createScriptNode(),this.createAnalyserNode()}},{key:"_load",value:function(e,t){Object(Wi["a"])(Object(Li["a"])(i.prototype),"_load",this).call(this,e,t),this.createMediaElementSource(e)}},{key:"createMediaElementSource",value:function(e){this.sourceMediaElement=this.ac.createMediaElementSource(e),this.sourceMediaElement.connect(this.analyser)}},{key:"destroy",value:function(){Object(Wi["a"])(Object(Li["a"])(i.prototype),"destroy",this).call(this),this.destroyWebAudio()}}]),i}(Fi),Ni=function(e){Object(S["a"])(i,e);var t=Object(P["a"])(i);function i(e){var n;if(Object(C["a"])(this,i),n=t.call(this),Object(E["a"])(Object(vi["a"])(n),"defaultParams",{audioContext:null,audioScriptProcessor:null,audioRate:1,autoCenter:!0,autoCenterRate:5,autoCenterImmediately:!1,backend:"WebAudio",backgroundColor:null,barHeight:1,barRadius:0,barGap:null,barMinHeight:null,container:null,cursorColor:"#333",cursorWidth:1,dragSelection:!0,drawingContextAttributes:{desynchronized:!1},duration:null,fillParent:!0,forceDecode:!1,height:128,hideScrollbar:!1,interact:!0,loopSelection:!0,maxCanvasWidth:4e3,mediaContainer:null,mediaControls:!1,mediaType:"audio",minPxPerSec:20,normalize:!1,partialRender:!1,pixelRatio:window.devicePixelRatio||screen.deviceXDPI/screen.logicalXDPI,plugins:[],progressColor:"#555",removeMediaElementOnDestroy:!0,renderer:Oi,responsive:!1,rtl:!1,scrollParent:!1,skipLength:2,splitChannels:!1,waveColor:"#999",xhr:{}}),Object(E["a"])(Object(vi["a"])(n),"backends",{MediaElement:Fi,WebAudio:Ii,MediaElementWebAudio:zi}),Object(E["a"])(Object(vi["a"])(n),"util",a),n.params=Object.assign({},n.defaultParams,e),n.container="string"==typeof e.container?document.querySelector(n.params.container):n.params.container,!n.container)throw new Error("Container element not found");if(null==n.params.mediaContainer?n.mediaContainer=n.container:"string"==typeof n.params.mediaContainer?n.mediaContainer=document.querySelector(n.params.mediaContainer):n.mediaContainer=n.params.mediaContainer,!n.mediaContainer)throw new Error("Media Container element not found");if(n.params.maxCanvasWidth<=1)throw new Error("maxCanvasWidth must be greater than 1");if(n.params.maxCanvasWidth%2==1)throw new Error("maxCanvasWidth must be an even number");if(!0===n.params.rtl&&ki(n.container,{transform:"rotateY(180deg)"}),n.params.backgroundColor&&n.setBackgroundColor(n.params.backgroundColor),n.savedVolume=0,n.isMuted=!1,n.tmpEvents=[],n.currentRequest=null,n.arraybuffer=null,n.drawer=null,n.backend=null,n.peakCache=null,"function"!==typeof n.params.renderer)throw new Error("Renderer parameter is invalid");n.Drawer=n.params.renderer,"AudioElement"==n.params.backend&&(n.params.backend="MediaElement"),"WebAudio"!=n.params.backend&&"MediaElementWebAudio"!==n.params.backend||Ii.prototype.supportsWebAudio.call(null)||(n.params.backend="MediaElement"),n.Backend=n.backends[n.params.backend],n.initialisedPluginList={},n.isDestroyed=!1,n.isReady=!1;var r=0;return n._onResize=Si.a((function(){r==n.drawer.wrapper.clientWidth||n.params.scrollParent||(r=n.drawer.wrapper.clientWidth,n.drawer.fireEvent("redraw"))}),"number"===typeof n.params.responsive?n.params.responsive:100),Object(fi["a"])(n,Object(vi["a"])(n))}return Object(_["a"])(i,null,[{key:"create",value:function(e){var t=new i(e);return t.init()}}]),Object(_["a"])(i,[{key:"init",value:function(){return this.registerPlugins(this.params.plugins),this.createDrawer(),this.createBackend(),this.createPeakCache(),this}},{key:"registerPlugins",value:function(e){var t=this;return e.forEach((function(e){return t.addPlugin(e)})),e.forEach((function(e){e.deferInit||t.initPlugin(e.name)})),this.fireEvent("plugins-registered",e),this}},{key:"getActivePlugins",value:function(){return this.initialisedPluginList}},{key:"addPlugin",value:function(e){var t=this;if(!e.name)throw new Error("Plugin does not have a name!");if(!e.instance)throw new Error("Plugin ".concat(e.name," does not have an instance property!"));e.staticProps&&Object.keys(e.staticProps).forEach((function(i){t[i]=e.staticProps[i]}));var i=e.instance,a=Object.getOwnPropertyNames(mi.prototype);return a.forEach((function(e){i.prototype[e]=mi.prototype[e]})),this[e.name]=new i(e.params||{},this),this.fireEvent("plugin-added",e.name),this}},{key:"initPlugin",value:function(e){if(!this[e])throw new Error("Plugin ".concat(e," has not been added yet!"));return this.initialisedPluginList[e]&&this.destroyPlugin(e),this[e].init(),this.initialisedPluginList[e]=!0,this.fireEvent("plugin-initialised",e),this}},{key:"destroyPlugin",value:function(e){if(!this[e])throw new Error("Plugin ".concat(e," has not been added yet and cannot be destroyed!"));if(!this.initialisedPluginList[e])throw new Error("Plugin ".concat(e," is not active and cannot be destroyed!"));if("function"!==typeof this[e].destroy)throw new Error("Plugin ".concat(e," does not have a destroy function!"));return this[e].destroy(),delete this.initialisedPluginList[e],this.fireEvent("plugin-destroyed",e),this}},{key:"destroyAllPlugins",value:function(){var e=this;Object.keys(this.initialisedPluginList).forEach((function(t){return e.destroyPlugin(t)}))}},{key:"createDrawer",value:function(){var e=this;this.drawer=new this.Drawer(this.container,this.params),this.drawer.init(),this.fireEvent("drawer-created",this.drawer),!1!==this.params.responsive&&(window.addEventListener("resize",this._onResize,!0),window.addEventListener("orientationchange",this._onResize,!0)),this.drawer.on("redraw",(function(){e.drawBuffer(),e.drawer.progress(e.backend.getPlayedPercents())})),this.drawer.on("click",(function(t,i){setTimeout((function(){return e.seekTo(i)}),0)})),this.drawer.on("scroll",(function(t){e.params.partialRender&&e.drawBuffer(),e.fireEvent("scroll",t)}))}},{key:"createBackend",value:function(){var e=this;this.backend&&this.backend.destroy(),this.backend=new this.Backend(this.params),this.backend.init(),this.fireEvent("backend-created",this.backend),this.backend.on("finish",(function(){e.drawer.progress(e.backend.getPlayedPercents()),e.fireEvent("finish")})),this.backend.on("play",(function(){return e.fireEvent("play")})),this.backend.on("pause",(function(){return e.fireEvent("pause")})),this.backend.on("audioprocess",(function(t){e.drawer.progress(e.backend.getPlayedPercents()),e.fireEvent("audioprocess",t)})),"MediaElement"!==this.params.backend&&"MediaElementWebAudio"!==this.params.backend||(this.backend.on("seek",(function(){e.drawer.progress(e.backend.getPlayedPercents())})),this.backend.on("volume",(function(){var t=e.getVolume();e.fireEvent("volume",t),e.backend.isMuted!==e.isMuted&&(e.isMuted=e.backend.isMuted,e.fireEvent("mute",e.isMuted))})))}},{key:"createPeakCache",value:function(){this.params.partialRender&&(this.peakCache=new Di)}},{key:"getDuration",value:function(){return this.backend.getDuration()}},{key:"getCurrentTime",value:function(){return this.backend.getCurrentTime()}},{key:"setCurrentTime",value:function(e){e>=this.getDuration()?this.seekTo(1):this.seekTo(e/this.getDuration())}},{key:"play",value:function(e,t){var i=this;return this.fireEvent("interaction",(function(){return i.play(e,t)})),this.backend.play(e,t)}},{key:"setPlayEnd",value:function(e){this.backend.setPlayEnd(e)}},{key:"pause",value:function(){if(!this.backend.isPaused())return this.backend.pause()}},{key:"playPause",value:function(){return this.backend.isPaused()?this.play():this.pause()}},{key:"isPlaying",value:function(){return!this.backend.isPaused()}},{key:"skipBackward",value:function(e){this.skip(-e||-this.params.skipLength)}},{key:"skipForward",value:function(e){this.skip(e||this.params.skipLength)}},{key:"skip",value:function(e){var t=this.getDuration()||1,i=this.getCurrentTime()||0;i=Math.max(0,Math.min(t,i+(e||0))),this.seekAndCenter(i/t)}},{key:"seekAndCenter",value:function(e){this.seekTo(e),this.drawer.recenter(e)}},{key:"seekTo",value:function(e){var t=this;if("number"!==typeof e||!isFinite(e)||e<0||e>1)throw new Error("Error calling wavesurfer.seekTo, parameter must be a number between 0 and 1!");this.fireEvent("interaction",(function(){return t.seekTo(e)}));var i=this.backend.isPaused();i||this.backend.pause();var a=this.params.scrollParent;this.params.scrollParent=!1,this.backend.seekTo(e*this.getDuration()),this.drawer.progress(e),i||this.backend.play(),this.params.scrollParent=a,this.fireEvent("seek",e)}},{key:"stop",value:function(){this.pause(),this.seekTo(0),this.drawer.progress(0)}},{key:"setSinkId",value:function(e){return this.backend.setSinkId(e)}},{key:"setVolume",value:function(e){this.backend.setVolume(e),this.fireEvent("volume",e)}},{key:"getVolume",value:function(){return this.backend.getVolume()}},{key:"setPlaybackRate",value:function(e){this.backend.setPlaybackRate(e)}},{key:"getPlaybackRate",value:function(){return this.backend.getPlaybackRate()}},{key:"toggleMute",value:function(){this.setMute(!this.isMuted)}},{key:"setMute",value:function(e){e!==this.isMuted?(e?(this.savedVolume=this.backend.getVolume(),this.backend.setVolume(0),this.isMuted=!0,this.fireEvent("volume",0)):(this.backend.setVolume(this.savedVolume),this.isMuted=!1,this.fireEvent("volume",this.savedVolume)),this.fireEvent("mute",this.isMuted)):this.fireEvent("mute",this.isMuted)}},{key:"getMute",value:function(){return this.isMuted}},{key:"getFilters",value:function(){return this.backend.filters||[]}},{key:"toggleScroll",value:function(){this.params.scrollParent=!this.params.scrollParent,this.drawBuffer()}},{key:"toggleInteraction",value:function(){this.params.interact=!this.params.interact}},{key:"getWaveColor",value:function(){return this.params.waveColor}},{key:"setWaveColor",value:function(e){this.params.waveColor=e,this.drawBuffer()}},{key:"getProgressColor",value:function(){return this.params.progressColor}},{key:"setProgressColor",value:function(e){this.params.progressColor=e,this.drawBuffer()}},{key:"getBackgroundColor",value:function(){return this.params.backgroundColor}},{key:"setBackgroundColor",value:function(e){this.params.backgroundColor=e,ki(this.container,{background:this.params.backgroundColor})}},{key:"getCursorColor",value:function(){return this.params.cursorColor}},{key:"setCursorColor",value:function(e){this.params.cursorColor=e,this.drawer.updateCursor()}},{key:"getHeight",value:function(){return this.params.height}},{key:"setHeight",value:function(e){this.params.height=e,this.drawer.setHeight(e*this.params.pixelRatio),this.drawBuffer()}},{key:"drawBuffer",value:function(){var e,t=Math.round(this.getDuration()*this.params.minPxPerSec*this.params.pixelRatio),i=this.drawer.getWidth(),a=t,n=0,r=Math.max(n+i,a);if(this.params.fillParent&&(!this.params.scrollParent||t<i)&&(a=i,n=0,r=a),this.params.partialRender){var s,o=this.peakCache.addRangeToPeakCache(a,n,r);for(s=0;s<o.length;s++)e=this.backend.getPeaks(a,o[s][0],o[s][1]),this.drawer.drawPeaks(e,a,o[s][0],o[s][1])}else e=this.backend.getPeaks(a,n,r),this.drawer.drawPeaks(e,a,n,r);this.fireEvent("redraw",e,a)}},{key:"zoom",value:function(e){e?(this.params.minPxPerSec=e,this.params.scrollParent=!0):(this.params.minPxPerSec=this.defaultParams.minPxPerSec,this.params.scrollParent=!1),this.drawBuffer(),this.drawer.progress(this.backend.getPlayedPercents()),this.drawer.recenter(this.getCurrentTime()/this.getDuration()),this.fireEvent("zoom",e)}},{key:"loadArrayBuffer",value:function(e){var t=this;this.decodeArrayBuffer(e,(function(e){t.isDestroyed||t.loadDecodedBuffer(e)}))}},{key:"loadDecodedBuffer",value:function(e){this.backend.load(e),this.drawBuffer(),this.isReady=!0,this.fireEvent("ready")}},{key:"loadBlob",value:function(e){var t=this,i=new FileReader;i.addEventListener("progress",(function(e){return t.onProgress(e)})),i.addEventListener("load",(function(e){return t.loadArrayBuffer(e.target.result)})),i.addEventListener("error",(function(){return t.fireEvent("error","Error reading file")})),i.readAsArrayBuffer(e),this.empty()}},{key:"load",value:function(e,t,i,a){if(!e)throw new Error("url parameter cannot be empty");if(this.empty(),i){var n={"Preload is not 'auto', 'none' or 'metadata'":-1===["auto","metadata","none"].indexOf(i),"Peaks are not provided":!t,"Backend is not of type 'MediaElement' or 'MediaElementWebAudio'":-1===["MediaElement","MediaElementWebAudio"].indexOf(this.params.backend),"Url is not of type string":"string"!==typeof e},r=Object.keys(n).filter((function(e){return n[e]}));r.length&&(console.warn("Preload parameter of wavesurfer.load will be ignored because:\n\t- "+r.join("\n\t- ")),i=null)}switch(this.params.backend){case"WebAudio":return this.loadBuffer(e,t,a);case"MediaElement":case"MediaElementWebAudio":return this.loadMediaElement(e,t,i,a)}}},{key:"loadBuffer",value:function(e,t,i){var a=this,n=function(t){return t&&a.tmpEvents.push(a.once("ready",t)),a.getArrayBuffer(e,(function(e){return a.loadArrayBuffer(e)}))};if(!t)return n();this.backend.setPeaks(t,i),this.drawBuffer(),this.tmpEvents.push(this.once("interaction",n))}},{key:"loadMediaElement",value:function(e,t,i,a){var n=this,r=e;if("string"===typeof e)this.backend.load(r,this.mediaContainer,t,i);else{var s=e;this.backend.loadElt(s,t),r=s.src}this.tmpEvents.push(this.backend.once("canplay",(function(){n.backend.destroyed||(n.drawBuffer(),n.isReady=!0,n.fireEvent("ready"))})),this.backend.once("error",(function(e){return n.fireEvent("error",e)}))),t&&this.backend.setPeaks(t,a),t&&!this.params.forceDecode||!this.backend.supportsWebAudio()||this.getArrayBuffer(r,(function(e){n.decodeArrayBuffer(e,(function(e){n.backend.buffer=e,n.backend.setPeaks(null),n.drawBuffer(),n.fireEvent("waveform-ready")}))}))}},{key:"decodeArrayBuffer",value:function(e,t){var i=this;this.arraybuffer=e,this.backend.decodeArrayBuffer(e,(function(a){i.isDestroyed||i.arraybuffer!=e||(t(a),i.arraybuffer=null)}),(function(){return i.fireEvent("error","Error decoding audiobuffer")}))}},{key:"getArrayBuffer",value:function(e,t){var i=this,a=Object.assign({url:e,responseType:"arraybuffer"},this.params.xhr),n=ji(a);return this.currentRequest=n,this.tmpEvents.push(n.on("progress",(function(e){i.onProgress(e)})),n.on("success",(function(e){t(e),i.currentRequest=null})),n.on("error",(function(e){i.fireEvent("error",e),i.currentRequest=null}))),n}},{key:"onProgress",value:function(e){var t;t=e.lengthComputable?e.loaded/e.total:e.loaded/(e.loaded+1e6),this.fireEvent("loading",Math.round(100*t),e.target)}},{key:"exportPCM",value:function(e,t,i,a,n){e=e||1024,a=a||0,t=t||1e4,i=i||!1;var r=this.backend.getPeaks(e,a,n),s=[].map.call(r,(function(e){return Math.round(e*t)/t}));return new Promise((function(e,t){var a=JSON.stringify(s);i||window.open("data:application/json;charset=utf-8,"+encodeURIComponent(a)),e(a)}))}},{key:"exportImage",value:function(e,t,i){return e||(e="image/png"),t||(t=1),i||(i="dataURL"),this.drawer.getImage(e,t,i)}},{key:"cancelAjax",value:function(){this.currentRequest&&this.currentRequest.controller&&(this.currentRequest.controller.abort(),this.currentRequest=null)}},{key:"clearTmpEvents",value:function(){this.tmpEvents.forEach((function(e){return e.un()}))}},{key:"empty",value:function(){this.backend.isPaused()||(this.stop(),this.backend.disconnectSource()),this.isReady=!1,this.cancelAjax(),this.clearTmpEvents(),this.drawer.progress(0),this.drawer.setWidth(0),this.drawer.drawPeaks({length:this.drawer.getWidth()},0)}},{key:"destroy",value:function(){this.destroyAllPlugins(),this.fireEvent("destroy"),this.cancelAjax(),this.clearTmpEvents(),this.unAll(),!1!==this.params.responsive&&(window.removeEventListener("resize",this._onResize,!0),window.removeEventListener("orientationchange",this._onResize,!0)),this.backend&&this.backend.destroy(),this.drawer&&this.drawer.destroy(),this.isDestroyed=!0,this.isReady=!1,this.arraybuffer=null}}]),i}(mi);Object(E["a"])(Ni,"VERSION","1.0 (fork at 2020-5-7 by qh73xe)"),Object(E["a"])(Ni,"util",a);i("fb6a"),i("6b93"),i("b680"),i("cfc3"),i("fb2c");var Bi=function(e,t,i,a){switch(this.bufferSize=e,this.sampleRate=t,this.bandwidth=2/e*(t/2),this.sinTable=new Float32Array(e),this.cosTable=new Float32Array(e),this.windowValues=new Float32Array(e),this.reverseTable=new Uint32Array(e),this.peakBand=0,this.peak=0,i){case"bartlett":for(n=0;n<e;n++)this.windowValues[n]=2/(e-1)*((e-1)/2-Math.abs(n-(e-1)/2));break;case"bartlettHann":for(n=0;n<e;n++)this.windowValues[n]=.62-.48*Math.abs(n/(e-1)-.5)-.38*Math.cos(2*Math.PI*n/(e-1));break;case"blackman":for(a=a||.16,n=0;n<e;n++)this.windowValues[n]=(1-a)/2-.5*Math.cos(2*Math.PI*n/(e-1))+a/2*Math.cos(4*Math.PI*n/(e-1));break;case"cosine":for(n=0;n<e;n++)this.windowValues[n]=Math.cos(Math.PI*n/(e-1)-Math.PI/2);break;case"gauss":for(a=a||.25,n=0;n<e;n++)this.windowValues[n]=Math.pow(Math.E,-.5*Math.pow((n-(e-1)/2)/(a*(e-1)/2),2));break;case"hamming":for(n=0;n<e;n++)this.windowValues[n]=.54-.46*Math.cos(2*Math.PI*n/(e-1));break;case"hann":case void 0:for(n=0;n<e;n++)this.windowValues[n]=.5*(1-Math.cos(2*Math.PI*n/(e-1)));break;case"lanczoz":for(n=0;n<e;n++)this.windowValues[n]=Math.sin(Math.PI*(2*n/(e-1)-1))/(Math.PI*(2*n/(e-1)-1));break;case"rectangular":for(n=0;n<e;n++)this.windowValues[n]=1;break;case"triangular":for(n=0;n<e;n++)this.windowValues[n]=2/e*(e/2-Math.abs(n-(e-1)/2));break;default:throw Error("No such window function '"+i+"'")}var n,r=1,s=e>>1;while(r<e){for(n=0;n<r;n++)this.reverseTable[n+r]=this.reverseTable[n]+s;r<<=1,s>>=1}for(n=0;n<e;n++)this.sinTable[n]=Math.sin(-Math.PI/n),this.cosTable[n]=Math.cos(-Math.PI/n);this.calculateSpectrum=function(e){var t,i,a,n=this.bufferSize,r=this.cosTable,s=this.sinTable,o=this.reverseTable,l=new Float32Array(n),c=new Float32Array(n),u=2/this.bufferSize,h=Math.sqrt,d=new Float32Array(n/2),f=Math.floor(Math.log(n)/Math.LN2);if(Math.pow(2,f)!==n)throw"Invalid buffer size, must be a power of 2.";if(n!==e.length)throw"Supplied buffer is not the same size as defined FFT. FFT Size: "+n+" Buffer Size: "+e.length;for(var v,m,p,g,b,y,w,k,x=1,C=0;C<n;C++)l[C]=e[o[C]]*this.windowValues[o[C]],c[C]=0;while(x<n){v=r[x],m=s[x],p=1,g=0;for(var _=0;_<x;_++){C=_;while(C<n)b=C+x,y=p*l[b]-g*c[b],w=p*c[b]+g*l[b],l[b]=l[C]-y,c[b]=c[C]-w,l[C]+=y,c[C]+=w,C+=x<<1;k=p,p=k*v-g*m,g=k*m+g*v}x<<=1}C=0;for(var S=n/2;C<S;C++)t=l[C],i=c[C],a=u*h(t*t+i*i),a>this.peak&&(this.peakBand=C,this.peak=a),d[C]=a;return d}},Ui=function(){function e(t,i){var a=this;Object(C["a"])(this,e),this.params=t,this.wavesurfer=i,this.util=i.util,this.frequenciesDataUrl=t.frequenciesDataUrl,this._onScroll=function(e){a.updateScroll(e)},this._onRender=function(){a.render()},this._onWrapperClick=function(e){a._wrapperClickHandler(e)},this._onReady=function(){var e=a.drawer=i.drawer;if(a.container="string"==typeof t.container?document.querySelector(t.container):t.container,!a.container)throw Error("No container for WaveSurfer spectrogram");if(t.colorMap){if(t.colorMap.length<256)throw new Error("Colormap must contain 256 elements");for(var n=0;n<t.colorMap.length;n++){var r=t.colorMap[n];if(4!==r.length)throw new Error("ColorMap entries must contain 4 values")}a.colorMap=t.colorMap}else{a.colorMap=[];for(var s=0;s<256;s++){var o=(255-s)/256;a.colorMap.push([o,o,o,1])}}a.width=e.width,a.pixelRatio=a.params.pixelRatio||i.params.pixelRatio,a.fftSamples=a.params.fftSamples||i.params.fftSamples||512,a.height=a.fftSamples/2,a.noverlap=t.noverlap,a.windowFunc=t.windowFunc,a.alpha=t.alpha,a.createWrapper(),a.createCanvas(),a.render(),e.wrapper.addEventListener("scroll",a._onScroll),i.on("redraw",a._onRender)}}return Object(_["a"])(e,null,[{key:"create",value:function(t){return{name:"spectrogram",deferInit:!(!t||!t.deferInit)&&t.deferInit,params:t,staticProps:{FFT:Bi},instance:e}}}]),Object(_["a"])(e,[{key:"init",value:function(){this.wavesurfer.isReady?this._onReady():this.wavesurfer.once("ready",this._onReady)}},{key:"destroy",value:function(){this.unAll(),this.wavesurfer.un("ready",this._onReady),this.wavesurfer.un("redraw",this._onRender),this.drawer.wrapper.removeEventListener("scroll",this._onScroll),this.wavesurfer=null,this.util=null,this.params=null,this.wrapper&&(this.wrapper.removeEventListener("click",this._onWrapperClick),this.wrapper.parentNode.removeChild(this.wrapper),this.wrapper=null)}},{key:"createWrapper",value:function(){var e=this.container.querySelector("spectrogram");e&&this.container.removeChild(e);var t=this.wavesurfer.params;if(this.wrapper=document.createElement("spectrogram"),this.params.labels){var i=this.labelsEl=document.createElement("canvas");i.classList.add("spec-labels"),this.drawer.style(i,{left:0,position:"absolute",zIndex:9,height:"".concat(this.height/this.pixelRatio,"px"),width:"".concat(55/this.pixelRatio,"px")}),this.wrapper.appendChild(i),this.loadLabels("rgba(68,68,68,0.5)","12px","10px","","#fff","#f7f7f7","center","#specLabels")}this.drawer.style(this.wrapper,{display:"block",position:"relative",userSelect:"none",webkitUserSelect:"none",height:"".concat(this.height/this.pixelRatio,"px")}),(t.fillParent||t.scrollParent)&&this.drawer.style(this.wrapper,{width:"100%",overflowX:"hidden",overflowY:"hidden"}),this.container.appendChild(this.wrapper),this.wrapper.addEventListener("click",this._onWrapperClick)}},{key:"_wrapperClickHandler",value:function(e){e.preventDefault();var t="offsetX"in e?e.offsetX:e.layerX;this.fireEvent("click",t/this.width||0)}},{key:"createCanvas",value:function(){var e=this.canvas=this.wrapper.appendChild(document.createElement("canvas"));this.spectrCc=e.getContext("2d"),this.util.style(e,{position:"absolute",zIndex:4})}},{key:"render",value:function(){this.updateCanvasStyle(),this.frequenciesDataUrl?this.loadFrequenciesData(this.frequenciesDataUrl):this.getFrequencies(this.drawSpectrogram)}},{key:"updateCanvasStyle",value:function(){var e=Math.round(this.width/this.pixelRatio)+"px";this.canvas.width=this.width,this.canvas.height=this.height,this.canvas.style.width=e}},{key:"drawSpectrogram",value:function(e,t){var i,a,n=t.height,r=t.resample(e),s=t.buffer?2/t.buffer.numberOfChannels:1;for(i=0;i<r.length;i++)for(a=0;a<r[i].length;a++){var o=t.colorMap[r[i][a]];t.spectrCc.fillStyle="rgba("+256*o[0]+", "+256*o[1]+", "+256*o[2]+","+o[3]+")",t.spectrCc.fillRect(i,n-a*s,1,s)}}},{key:"getFrequencies",value:function(e){var t=this.fftSamples,i=this.buffer=this.wavesurfer.backend.buffer;if(i){var a=i.getChannelData(0),n=i.sampleRate,r=[],s=this.noverlap;if(!s){var o=i.length/this.canvas.width;s=Math.max(0,Math.round(t-o))}var l=new Bi(t,n,this.windowFunc,this.alpha),c=0;while(c+t<a.length){var u=a.slice(c,c+t),h=l.calculateSpectrum(u),d=new Uint8Array(t/2),f=void 0;for(f=0;f<t/2;f++)d[f]=Math.max(-255,45*Math.log10(h[f]));r.push(d),c+=t-s}e(r,this)}else this.fireEvent("error","Web Audio buffer is not available")}},{key:"loadFrequenciesData",value:function(e){var t=this,i=this.util.fetchFile({url:e});return i.on("success",(function(e){return t.drawSpectrogram(JSON.parse(e),t)})),i.on("error",(function(e){return t.fireEvent("error",e)})),i}},{key:"freqType",value:function(e){return e>=1e3?(e/1e3).toFixed(1):Math.round(e)}},{key:"unitType",value:function(e){return e>=1e3?"KHz":"Hz"}},{key:"loadLabels",value:function(e,t,i,a,n,r,s){var o=this.height;e=e||"rgba(68,68,68,0)",t=t||"12px",i=i||"10px",a=a||"Helvetica",n=n||"#fff",r=r||"#fff",s=s||"center";var l,c=55,u=o||512,h=u/256*5,d=0,f=(this.wavesurfer.backend.ac.sampleRate/2-d)/h,v=this.labelsEl.getContext("2d");for(this.labelsEl.height=this.height,this.labelsEl.width=c,v.fillStyle=e,v.fillRect(0,0,c,u),v.fill(),l=0;l<=h;l++){v.textAlign=s,v.textBaseline="middle";var m=d+f*l,p=this.freqType(m),g=this.unitType(m),b=2,y=16,w=void 0;0==l?(w=u+l-10,v.fillStyle=r,v.font=i+" "+a,v.fillText(g,y+24,w),v.fillStyle=n,v.font=t+" "+a,v.fillText(p,y,w)):(w=u-50*l+b,v.fillStyle=r,v.font=i+" "+a,v.fillText(g,y+24,w),v.fillStyle=n,v.font=t+" "+a,v.fillText(p,y,w))}}},{key:"updateScroll",value:function(e){this.wrapper&&(this.wrapper.scrollLeft=e.target.scrollLeft)}},{key:"resample",value:function(e){var t,i=this.width,a=[],n=1/e.length,r=1/i;for(t=0;t<i;t++){var s=new Array(e[0].length),o=void 0;for(o=0;o<e.length;o++){var l=o*n,c=l+n,u=t*r,h=u+r,d=c<=u||h<=l?0:Math.min(Math.max(c,u),Math.max(h,l))-Math.max(Math.min(c,u),Math.min(h,l)),f=void 0;if(d>0)for(f=0;f<e[0].length;f++)null==s[f]&&(s[f]=0),s[f]+=d/r*e[o][f]}var v=new Uint8Array(e[0].length),m=void 0;for(m=0;m<e[0].length;m++)v[m]=s[m];a.push(v)}return a}}]),e}(),qi=function(){function e(t,i){var a=this;if(Object(C["a"])(this,e),Object(E["a"])(this,"_onScroll",(function(){a.wrapper&&a.drawer.wrapper&&(a.wrapper.scrollLeft=a.drawer.wrapper.scrollLeft)})),Object(E["a"])(this,"_onRedraw",(function(){return a.render()})),Object(E["a"])(this,"_onReady",(function(){var e=a.wavesurfer;a.drawer=e.drawer,a.pixelRatio=e.drawer.params.pixelRatio,a.maxCanvasWidth=e.drawer.maxCanvasWidth||e.drawer.width,a.maxCanvasElementWidth=e.drawer.maxCanvasElementWidth||Math.round(a.maxCanvasWidth/a.pixelRatio),e.drawer.wrapper.addEventListener("scroll",a._onScroll),e.on("redraw",a._onRedraw),e.on("zoom",a._onZoom),a.render()})),Object(E["a"])(this,"_onWrapperClick",(function(e){e.preventDefault();var t="offsetX"in e?e.offsetX:e.layerX;a.fireEvent("click",t/a.wrapper.scrollWidth||0)})),this.container="string"==typeof t.container?document.querySelector(t.container):t.container,!this.container)throw new Error("No container for wavesurfer timeline");this.wavesurfer=i,this.util=i.util,this.params=Object.assign({},{height:20,notchPercentHeight:90,labelPadding:5,unlabeledNotchColor:"#c0c0c0",primaryColor:"#000",secondaryColor:"#c0c0c0",primaryFontColor:"#000",secondaryFontColor:"#000",fontFamily:"Arial",fontSize:10,duration:null,zoomDebounce:!1,formatTimeCallback:this.defaultFormatTimeCallback,timeInterval:this.defaultTimeInterval,primaryLabelInterval:this.defaultPrimaryLabelInterval,secondaryLabelInterval:this.defaultSecondaryLabelInterval,offset:0},t),this.canvases=[],this.wrapper=null,this.drawer=null,this.pixelRatio=null,this.maxCanvasWidth=null,this.maxCanvasElementWidth=null,this._onZoom=this.params.zoomDebounce?this.wavesurfer.util.debounce((function(){return a.render()}),this.params.zoomDebounce):function(){return a.render()}}return Object(_["a"])(e,null,[{key:"create",value:function(t){return{name:"timeline",deferInit:!(!t||!t.deferInit)&&t.deferInit,params:t,instance:e}}}]),Object(_["a"])(e,[{key:"init",value:function(){this.wavesurfer.isReady?this._onReady():this.wavesurfer.once("ready",this._onReady)}},{key:"destroy",value:function(){this.unAll(),this.wavesurfer.un("redraw",this._onRedraw),this.wavesurfer.un("zoom",this._onZoom),this.wavesurfer.un("ready",this._onReady),this.wavesurfer.drawer.wrapper.removeEventListener("scroll",this._onScroll),this.wrapper&&this.wrapper.parentNode&&(this.wrapper.removeEventListener("click",this._onWrapperClick),this.wrapper.parentNode.removeChild(this.wrapper),this.wrapper=null)}},{key:"createWrapper",value:function(){var e=this.wavesurfer.params;this.container.innerHTML="",this.wrapper=this.container.appendChild(document.createElement("timeline")),this.util.style(this.wrapper,{display:"block",position:"relative",userSelect:"none",webkitUserSelect:"none",height:"".concat(this.params.height,"px")}),(e.fillParent||e.scrollParent)&&this.util.style(this.wrapper,{width:"100%",overflowX:"hidden",overflowY:"hidden"}),this.wrapper.addEventListener("click",this._onWrapperClick)}},{key:"render",value:function(){this.wrapper||this.createWrapper(),this.updateCanvases(),this.updateCanvasesPositioning(),this.renderCanvases()}},{key:"addCanvas",value:function(){var e=this.wrapper.appendChild(document.createElement("canvas"));this.canvases.push(e),this.util.style(e,{position:"absolute",zIndex:4})}},{key:"removeCanvas",value:function(){var e=this.canvases.pop();e.parentElement.removeChild(e)}},{key:"updateCanvases",value:function(){var e=Math.round(this.drawer.wrapper.scrollWidth),t=Math.ceil(e/this.maxCanvasElementWidth);while(this.canvases.length<t)this.addCanvas();while(this.canvases.length>t)this.removeCanvas()}},{key:"updateCanvasesPositioning",value:function(){var e=this,t=this.canvases.length;this.canvases.forEach((function(i,a){var n=a===t-1?e.drawer.wrapper.scrollWidth-e.maxCanvasElementWidth*(t-1):e.maxCanvasElementWidth;i.width=n*e.pixelRatio,i.height=(e.params.height+1)*e.pixelRatio,e.util.style(i,{width:"".concat(n,"px"),height:"".concat(e.params.height,"px"),left:"".concat(a*e.maxCanvasElementWidth,"px")})}))}},{key:"renderCanvases",value:function(){var e=this,t=this.params.duration||this.wavesurfer.backend.getDuration();if(!(t<=0)){var i,a=this.wavesurfer.params,n=this.params.fontSize*a.pixelRatio,r=parseInt(t,10)+1,s=a.fillParent&&!a.scrollParent?this.drawer.getWidth():this.drawer.wrapper.scrollWidth*a.pixelRatio,o=this.params.height*this.pixelRatio,l=this.params.height*(this.params.notchPercentHeight/100)*this.pixelRatio,c=s/t,u=this.params.formatTimeCallback,h=function(e){return"function"===typeof e?e(c):e},d=h(this.params.timeInterval),f=h(this.params.primaryLabelInterval),v=h(this.params.secondaryLabelInterval),m=c*this.params.offset,p=0,g=[];for(i=0;i<r/d;i++)g.push([i,p,m]),p+=d,m+=c*d;var b=function(e){g.forEach((function(t){e(t[0],t[1],t[2])}))};this.setFillStyles(this.params.primaryColor),this.setFonts("".concat(n,"px ").concat(this.params.fontFamily)),this.setFillStyles(this.params.primaryFontColor),b((function(t,i,a){t%f===0&&(e.fillRect(a,0,1,o),e.fillText(u(i,c),a+e.params.labelPadding*e.pixelRatio,o))})),this.setFillStyles(this.params.secondaryColor),this.setFonts("".concat(n,"px ").concat(this.params.fontFamily)),this.setFillStyles(this.params.secondaryFontColor),b((function(t,i,a){t%v===0&&(e.fillRect(a,0,1,o),e.fillText(u(i,c),a+e.params.labelPadding*e.pixelRatio,o))})),this.setFillStyles(this.params.unlabeledNotchColor),b((function(t,i,a){t%v!==0&&t%f!==0&&e.fillRect(a,0,1,l)}))}}},{key:"setFillStyles",value:function(e){this.canvases.forEach((function(t){t.getContext("2d").fillStyle=e}))}},{key:"setFonts",value:function(e){this.canvases.forEach((function(t){t.getContext("2d").font=e}))}},{key:"fillRect",value:function(e,t,i,a){var n=this;this.canvases.forEach((function(r,s){var o=s*n.maxCanvasWidth,l={x1:Math.max(e,s*n.maxCanvasWidth),y1:t,x2:Math.min(e+i,s*n.maxCanvasWidth+r.width),y2:t+a};l.x1<l.x2&&r.getContext("2d").fillRect(l.x1-o,l.y1,l.x2-l.x1,l.y2-l.y1)}))}},{key:"fillText",value:function(e,t,i){var a,n=0;this.canvases.forEach((function(r){var s=r.getContext("2d"),o=s.canvas.width;n>t+a||(n+o>t&&(a=s.measureText(e).width,s.fillText(e,t-n,i)),n+=o)}))}},{key:"defaultFormatTimeCallback",value:function(e,t){if(e/60>1){var i=parseInt(e/60,10);return e=parseInt(e%60,10),e=e<10?"0"+e:e,"".concat(i,":").concat(e)}return Math.round(1e3*e)/1e3}},{key:"defaultTimeInterval",value:function(e){return e>=25?1:5*e>=25?5:15*e>=25?15:60*Math.ceil(.5/e)}},{key:"defaultPrimaryLabelInterval",value:function(e){return e>=25?10:5*e>=25?6:4}},{key:"defaultSecondaryLabelInterval",value:function(e){return e>=25?5:2}}]),e}(),Hi=function(){function e(t,i){var a=this;if(Object(C["a"])(this,e),this.params=Object.assign({},i.params,{showRegions:!1,showOverview:!1,overviewBorderColor:"green",overviewBorderSize:2,container:!1,height:Math.max(Math.round(i.params.height/4),20)},t,{scrollParent:!1,fillParent:!0}),"string"===typeof t.container){var n=document.querySelector(t.container);n||console.warn("Wavesurfer minimap container ".concat(t.container," was not found! The minimap will be automatically appended below the waveform.")),this.params.container=n}t.container||(this.params.container=i.util.style(document.createElement("minimap"),{display:"block"})),this.drawer=new i.Drawer(this.params.container,this.params),this.wavesurfer=i,this.util=i.util,this.renderEvent="MediaElement"===i.params.backend?"waveform-ready":"ready",this.overviewRegion=null,this.drawer.createWrapper(),this.createElements();var r=!1;this._onShouldRender=function(){r||(a.bindWavesurferEvents(),a.bindMinimapEvents(),r=!0),document.body.contains(a.params.container)||i.container.insertBefore(a.params.container,null),a.wavesurfer.regions&&a.params.showRegions&&a.regions(),a.render()},this._onAudioprocess=function(e){a.drawer.progress(a.wavesurfer.backend.getPlayedPercents())},this._onSeek=function(){return a.drawer.progress(i.backend.getPlayedPercents())},this._onScroll=function(e){a.draggingOverview||a.moveOverviewRegion(e.target.scrollLeft/a.ratio)},this._onMouseover=function(e){a.draggingOverview&&(a.draggingOverview=!1)};var s=0;this._onResize=i.util.debounce((function(){s!=a.drawer.wrapper.clientWidth&&(s=a.drawer.wrapper.clientWidth,a.render(),a.drawer.progress(a.wavesurfer.backend.getPlayedPercents()))})),this._onZoom=function(e){a.render()},this.wavesurfer.on("zoom",this._onZoom)}return Object(_["a"])(e,null,[{key:"create",value:function(t){return{name:"minimap",deferInit:!(!t||!t.deferInit)&&t.deferInit,params:t,staticProps:{},instance:e}}}]),Object(_["a"])(e,[{key:"init",value:function(){this.wavesurfer.isReady&&this._onShouldRender(),this.wavesurfer.on(this.renderEvent,this._onShouldRender)}},{key:"destroy",value:function(){window.removeEventListener("resize",this._onResize,!0),window.removeEventListener("orientationchange",this._onResize,!0),this.wavesurfer.drawer.wrapper.removeEventListener("mouseover",this._onMouseover),this.wavesurfer.un(this.renderEvent,this._onShouldRender),this.wavesurfer.un("seek",this._onSeek),this.wavesurfer.un("scroll",this._onScroll),this.wavesurfer.un("audioprocess",this._onAudioprocess),this.wavesurfer.un("zoom",this._onZoom),this.drawer.destroy(),this.overviewRegion=null,this.unAll()}},{key:"regions",value:function(){var e=this;this.regions={},this.wavesurfer.on("region-created",(function(t){e.regions[t.id]=t,e.renderRegions()})),this.wavesurfer.on("region-updated",(function(t){e.regions[t.id]=t,e.renderRegions()})),this.wavesurfer.on("region-removed",(function(t){delete e.regions[t.id],e.renderRegions()}))}},{key:"renderRegions",value:function(){var e,t=this,i=this.drawer.wrapper.querySelectorAll("region");for(e=0;e<i.length;++e)this.drawer.wrapper.removeChild(i[e]);Object.keys(this.regions).forEach((function(e){var i=t.regions[e],a=t.getWidth()*((i.end-i.start)/t.wavesurfer.getDuration()),n=t.getWidth()*(i.start/t.wavesurfer.getDuration()),r=t.util.style(document.createElement("region"),{height:"inherit",backgroundColor:i.color,width:a+"px",left:n+"px",display:"block",position:"absolute"});r.classList.add(e),t.drawer.wrapper.appendChild(r)}))}},{key:"createElements",value:function(){this.drawer.createElements(),this.params.showOverview&&(this.overviewRegion=this.util.style(document.createElement("overview"),{top:0,bottom:0,width:"0px",display:"block",position:"absolute",cursor:"move",border:this.params.overviewBorderSize+"px solid "+this.params.overviewBorderColor,zIndex:2,opacity:this.params.overviewOpacity}),this.drawer.wrapper.appendChild(this.overviewRegion))}},{key:"bindWavesurferEvents",value:function(){window.addEventListener("resize",this._onResize,!0),window.addEventListener("orientationchange",this._onResize,!0),this.wavesurfer.on("audioprocess",this._onAudioprocess),this.wavesurfer.on("seek",this._onSeek),this.params.showOverview&&(this.wavesurfer.on("scroll",this._onScroll),this.wavesurfer.drawer.wrapper.addEventListener("mouseover",this._onMouseover))}},{key:"bindMinimapEvents",value:function(){var e=this,t={clientX:0,clientY:0},i=0,a=!0;this.params.interact&&(this.drawer.wrapper.addEventListener("click",(function(t){e.fireEvent("click",t,e.drawer.handleEvent(t))})),this.on("click",(function(t,i){a?(e.drawer.progress(i),e.wavesurfer.seekAndCenter(i)):a=!0}))),this.params.showOverview&&(this.overviewRegion.addEventListener("mousedown",(function(a){e.draggingOverview=!0,i=a.layerX,t.clientX=a.clientX,t.clientY=a.clientY})),this.drawer.wrapper.addEventListener("mousemove",(function(t){e.draggingOverview&&e.moveOverviewRegion(t.clientX-e.drawer.container.getBoundingClientRect().left-i)})),this.drawer.wrapper.addEventListener("mouseup",(function(i){t.clientX-i.clientX===0&&t.clientX-i.clientX===0?(a=!0,e.draggingOverview=!1):e.draggingOverview&&(a=!1,e.draggingOverview=!1)})))}},{key:"render",value:function(){var e=this.drawer.getWidth(),t=this.wavesurfer.backend.getPeaks(e,0,e);this.drawer.drawPeaks(t,e,0,e),this.drawer.progress(this.wavesurfer.backend.getPlayedPercents()),this.params.showOverview&&(this.ratio=this.wavesurfer.drawer.width/this.drawer.width,this.waveShowedWidth=this.wavesurfer.drawer.width/this.ratio,this.waveWidth=this.wavesurfer.drawer.width,this.overviewWidth=this.drawer.container.offsetWidth/this.ratio,this.overviewPosition=0,this.moveOverviewRegion(this.wavesurfer.drawer.wrapper.scrollLeft/this.ratio),this.overviewRegion.style.width=this.overviewWidth+"px")}},{key:"moveOverviewRegion",value:function(e){e<0?this.overviewPosition=0:e+this.overviewWidth<this.drawer.container.offsetWidth?this.overviewPosition=e:this.overviewPosition=this.drawer.container.offsetWidth-this.overviewWidth,this.overviewRegion.style.left=this.overviewPosition+"px",this.draggingOverview&&(this.wavesurfer.drawer.wrapper.scrollLeft=this.overviewPosition*this.ratio)}},{key:"getWidth",value:function(){return this.drawer.width/this.params.pixelRatio}}]),e}(),Xi=(i("c740"),{}),Gi=function(){function e(t,i){var a=this;if(Object(C["a"])(this,e),Object(E["a"])(this,"_onScroll",(function(){a.wrapper&&a.drawer.wrapper&&(a.wrapper.scrollLeft=a.drawer.wrapper.scrollLeft)})),Object(E["a"])(this,"_onRedraw",(function(){return a.render()})),Object(E["a"])(this,"_onReady",(function(){var e=a.wavesurfer;a.drawer=e.drawer,a.pixelRatio=e.drawer.params.pixelRatio,a.isDragging=!1,a.draggingItemIdx=null;var t=e.params;a.duration=a.wavesurfer.backend.getDuration();var i=t.fillParent&&!t.scrollParent?a.drawer.getWidth():a.drawer.wrapper.scrollWidth*t.pixelRatio;a.pixelsPerSecond=i/a.duration,a.maxCanvasWidth=e.drawer.maxCanvasWidth||e.drawer.width,a.maxCanvasElementWidth=e.drawer.maxCanvasElementWidth||Math.round(a.maxCanvasWidth/a.pixelRatio),e.drawer.wrapper.addEventListener("scroll",a._onScroll),e.on("redraw",a._onRedraw),e.on("zoom",a._onZoom),a.render()})),Object(E["a"])(this,"_onWrapperClick",(function(e){e.preventDefault();var t="offsetX"in e?e.offsetX:e.layerX,i=t/a.pixelsPerSecond,n=a.getCurrentItemIndex(i);for(var r in a.items)a.items[r].color=null,r==n&&("interval"==a.tierType?a.items[n].color=a.params.focusColor:a.items[n].color=a.params.focusPointColor,a.lastIdx=n);a.updateCanvases(),a.updateCanvasesPositioning(),a.renderCanvases(),a.wavesurfer.seekTo(i/a.duration);var s={name:a.name,id:Number(n),item:a.items[n]};a.wavesurfer.fireEvent("multiline-update-current",s)})),Object(E["a"])(this,"_onDblClick",(function(e){e.preventDefault();var t="offsetX"in e?e.offsetX:e.layerX,i=t/a.pixelsPerSecond;a.addItem({time:i,text:"",color:null})})),Object(E["a"])(this,"_onMouseMove",(function(e){e.preventDefault();var t="offsetX"in e?e.offsetX:e.layerX,i=t/a.pixelsPerSecond;a.isCollisioned(i)?(i.toFixed(a.params.csd)>0&&(document.body.style.cursor="col-resize"),"point"==a.tierType&&(a.lastIdx=a.getCurrentItemIndex(i))):a.isDragging?a.draggingItemIdx>0&&(a.items[a.draggingItemIdx].time=i,a.items=a.items.sort((function(e,t){return e.time-t.time})),a.wavesurfer.fireEvent("multiline-update-tiers"),a.updateCanvases(),a.updateCanvasesPositioning(),a.renderCanvases()):document.body.style.cursor="default"})),Object(E["a"])(this,"_onMouseUp",(function(e){e.preventDefault(),a.isDragging&&(a.isDragging=!1,document.body.style.cursor="default")})),Object(E["a"])(this,"_onMouseDown",(function(e){e.preventDefault();var t="offsetX"in e?e.offsetX:e.layerX,i=t/a.pixelsPerSecond;a.isDragging=!1,a.isCollisioned(i)&&i.toFixed(a.params.csd)>0&&(a.draggingItemIdx=a.getCurrentItemIndex(i),a.isDragging=!0)})),Object(E["a"])(this,"_onMouseOut",(function(e){for(var t in e.preventDefault(),document.body.style.cursor="default",a.items)a.items[t].color=null;a.updateCanvases(),a.updateCanvasesPositioning(),a.renderCanvases(),a.wrapper.style.backgroundColor=null})),Object(E["a"])(this,"_onKeyDown",(function(e){"Shift"!=e.key&&(e.preventDefault(),"Control"!=e.key&&"Alt"!=e.key?("Backspace"==e.key?a._onKeyBackSpace():"Tab"==e.key&&a._onTab(),a.onCtrl=!1):a.onCtrl=!0)})),Object(E["a"])(this,"_onKeyBackSpace",(function(){if(a.lastIdx)if(!0===a.onCtrl)a.deleteItem(a.lastIdx);else{a.items[a.lastIdx].text=a.items[a.lastIdx].text.slice(0,-1),a.items=a.items.sort((function(e,t){return e.time-t.time})),a.updateCanvases(),a.updateCanvasesPositioning(),a.renderCanvases();var e={name:a.name,id:Number(a.lastIdx),item:a.items[a.lastIdx]};a.wavesurfer.fireEvent("multiline-update-tiers"),a.wavesurfer.fireEvent("multiline-update-tiers",e)}})),Object(E["a"])(this,"_onTab",(function(){var e;e=a.lastIdx!=a.items.length-1?a.items[a.lastIdx+1].time:a.duration,a.wavesurfer.isPlaying()?a.wavesurfer.pause():(a.wavesurfer.play(a.items[a.lastIdx].time,e),a.fireEvent("play"),a.wavesurfer.fireEvent("region-play",a))})),this.wavesurfer=i,this.util=i.util,this.container="string"==typeof t.container?document.querySelector(t.container):t.container,!this.container)throw new Error("No container for wavesurfer multiline");if(this.wavesurfer.getTierNum=function(){return a.container.children.length},this.wavesurfer.getTiers=function(){var e=[];for(var t in a.tiers)e.push({name:a.tiers[t].name,tierType:a.tiers[t].tierType,items:a.tiers[t].items});return e},this.name="string"==typeof t.name?t.name:String(t.name),!this.name)throw new Error("No name for wavesurfer multiline");if(this.tierType="string"==typeof t.tierType?t.tierType:null,!this.tierType)throw new Error("No tierType for wavesurfer multiline");if("interval"!=this.tierType&&"point"!=this.tierType)throw new Error("".concat(this.tierType," is not supported tierType"));this.tiers=Xi,this.tiers[this.name]=this,this.items=t.items,this.wavesurfer.fireEvent("multiline-update-tiers"),this.params=this.util.extend({},{csd:1,height:50,notchPercentHeight:90,labelPadding:5,focusBgColor:"#CFD8DC",focusColor:"#FFE082",focusPointColor:"#F44336",Color:"#000000",fontFamily:"Arial",fontSize:10,zoomDebounce:!1,formatTimeCallback:this.defaultFormatTimeCallback,offset:0},t),this.canvases=[],this.wrapper=null,this.drawer=null,this.pixelRatio=null,this.maxCanvasWidth=null,this.maxCanvasElementWidth=null,this.onCtrl=!1,this.lastIdx=null,this._onZoom=this.params.zoomDebounce?this.wavesurfer.util.debounce((function(){return a.render()}),this.params.zoomDebounce):function(){return a.render()}}return Object(_["a"])(e,null,[{key:"create",value:function(t){return{name:"multiline",deferInit:!(!t||!t.deferInit)&&t.deferInit,params:t,instance:e}}}]),Object(_["a"])(e,[{key:"init",value:function(){this.wavesurfer.isReady?this._onReady():this.wavesurfer.once("ready",this._onReady)}},{key:"destroy",value:function(){this.unAll(),this.wavesurfer.un("redraw",this._onRedraw),this.wavesurfer.un("zoom",this._onZoom),this.wavesurfer.un("ready",this._onReady),this.wavesurfer.drawer.wrapper.removeEventListener("scroll",this._onScroll),this.wrapper&&this.wrapper.parentNode&&(this.wrapper.removeEventListener("click",this._onWrapperClick),this.wrapper.parentNode.removeChild(this.wrapper),this.wrapper=null)}},{key:"getCurrentItem",value:function(e){var t=this;if("interval"==this.tierType){var i=this.items.find((function(i){return e.toFixed(t.params.csd)==i.time.toFixed(t.params.csd)}));if(i)return i;var a=this.items.filter((function(t){return e>=t.time}));return a.length>0?a[a.length-1]:void 0}var n=this.items.map((function(t){return{check:Math.abs(t.time-e),item:t}}));return n.sort((function(e,t){return e.check-t.check})),n.length>0?n[0].item:void 0}},{key:"getCurrentItemIndex",value:function(e){var t=this.getCurrentItem(e);return t?this.items.findIndex((function(e){return e.time==t.time})):null}},{key:"findItemByTime",value:function(e){return this.items.find((function(t){return t.time==e}))}},{key:"findItemIndexByTime",value:function(e){return this.items.findIndex((function(t){return t.time==e}))}},{key:"addItem",value:function(e){this.items.push(e),this.items=this.items.sort((function(e,t){return e.time-t.time})),this.wavesurfer.fireEvent("multiline-update-tiers"),this.updateCanvases(),this.updateCanvasesPositioning(),this.renderCanvases()}},{key:"deleteItem",value:function(e){this.items.splice(e,1),this.items=this.items.sort((function(e,t){return e.time-t.time})),this.wavesurfer.fireEvent("multiline-update-tiers"),this.updateCanvases(),this.updateCanvasesPositioning(),this.renderCanvases()}},{key:"putText",value:function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.items=this.items.sort((function(e,t){e.time,t.time})),this.items[e].text=t,this.wavesurfer.fireEvent("multiline-update-tiers"),!0===i&&(this.updateCanvases(),this.updateCanvasesPositioning(),this.renderCanvases())}},{key:"isCollisioned",value:function(e){var t=this;return this.items.some((function(i){return e.toFixed(t.params.csd)==i.time.toFixed(t.params.csd)}))}},{key:"createWrapper",value:function(){var e=this.wavesurfer.params;this.wrapper=this.container.appendChild(document.createElement("multiline-".concat(this.name))),this.util.style(this.wrapper,{display:"block",position:"relative",userSelect:"none",webkitUserSelect:"none",height:"".concat(this.params.height,"px")});var t=this.container.children;1==t.length?this.util.style(this.wrapper,{"border-top":"solid 1px gray","border-bottom":"solid 1px gray"}):this.util.style(this.wrapper,{"border-bottom":"solid 1px gray"}),(e.fillParent||e.scrollParent)&&this.util.style(this.wrapper,{width:"100%",overflowX:"hidden",overflowY:"hidden"}),this.wrapper.addEventListener("click",this._onWrapperClick)}},{key:"render",value:function(){this.wrapper||this.createWrapper(),this.updateCanvases(),this.updateCanvasesPositioning(),this.renderCanvases()}},{key:"addCanvas",value:function(){var e=this,t=this.wrapper.appendChild(document.createElement("canvas"));t.addEventListener("dblclick",this._onDblClick,!1),t.addEventListener("mousemove",this._onMouseMove,!1),t.addEventListener("mousedown",this._onMouseDown,!1),t.addEventListener("mouseup",this._onMouseUp,!1),t.addEventListener("mouseover",(function(){t.focus(),e.wrapper.style.backgroundColor=e.params.focusBgColor}),!1),t.addEventListener("mouseout",this._onMouseOut,!1),t.addEventListener("keydown",this._onKeyDown,!1),t.setAttribute("tabindex",0),this.canvases.push(t),this.util.style(t,{position:"absolute",zIndex:4})}},{key:"removeCanvas",value:function(){var e=this.canvases.pop();e.parentElement.removeChild(e)}},{key:"updateCanvases",value:function(){var e=Math.round(this.drawer.wrapper.scrollWidth),t=Math.ceil(e/this.maxCanvasElementWidth);while(this.canvases.length<t)this.addCanvas();while(this.canvases.length>t)this.removeCanvas()}},{key:"updateCanvasesPositioning",value:function(){var e=this,t=this.canvases.length;this.canvases.forEach((function(i,a){var n=a===t-1?e.drawer.wrapper.scrollWidth-e.maxCanvasElementWidth*(t-1):e.maxCanvasElementWidth;i.width=n*e.pixelRatio,i.height=(e.params.height+1)*e.pixelRatio,e.util.style(i,{width:"".concat(n,"px"),height:"".concat(e.params.height,"px"),left:"".concat(a*e.maxCanvasElementWidth,"px")})}))}},{key:"renderCanvases",value:function(){var e=this;if(!(this.duration<=0)){var t=this.wavesurfer.params,i=t.fillParent&&!t.scrollParent?this.drawer.getWidth():this.drawer.wrapper.scrollWidth*t.pixelRatio,a=this.params.height*this.pixelRatio,n=this.params.fontSize*t.pixelRatio;this.setFillStyles(this.params.Color),this.setFonts("".concat(n,"px ").concat(this.params.fontFamily)),this.fillLine(0,0,1,a),this.items.forEach((function(t,i){var r=e.pixelsPerSecond*t.time;if("interval"==e.tierType){if(t.color){var s;s=i<e.items.length-1?e.items[i+1].time-t.time:e.duration-t.time;var o=s*e.pixelsPerSecond;e.fillRect(r,0,o,a,t.color)}e.fillLine(r,0,1,a),e.fillText(t.text,r,a/2,n)}else t.text?t.color?(e.fillText(t.text,r,a/2,n,t.color),e.fillLine(r,0,3,a/4,t.color)):(e.fillText(t.text,r,a/2,n),e.fillLine(r,0,1,a/4)):t.color?e.fillLine(r,0,3,a,t.color):e.fillLine(r,0,1,a)})),this.fillLine(i,0,1,a)}}},{key:"setFillStyles",value:function(e){this.canvases.forEach((function(t){t.getContext("2d").fillStyle=e}))}},{key:"getFillStyles",value:function(){this.canvases.forEach((function(e){return e.getContext("2d").fillStyle}))}},{key:"setFonts",value:function(e){this.canvases.forEach((function(t){t.getContext("2d").font=e}))}},{key:"fillRect",value:function(e,t,i,a,n){var r=this;this.setFillStyles(n),this.canvases.forEach((function(n,s){var o=s*r.maxCanvasWidth,l={x:Math.max(e,s*r.maxCanvasWidth),y2:t+a};n.getContext("2d").fillRect(l.x-o,t,i,l.y2-t)})),this.setFillStyles(this.params.Color)}},{key:"fillLine",value:function(e,t,i,a,n){var r=this;this.setFillStyles(n),this.canvases.forEach((function(n,s){var o=s*r.maxCanvasWidth,l={x1:Math.max(e,s*r.maxCanvasWidth),y1:t,x2:Math.min(e+i,s*r.maxCanvasWidth+n.width),y2:t+a};l.x1<l.x2?n.getContext("2d").fillRect(l.x1-o,l.y1,l.x2-l.x1,l.y2-l.y1):n.getContext("2d").fillRect(l.x1-1-o,l.y1,1,l.y2-l.y1)})),this.setFillStyles(this.params.Color)}},{key:"fillText",value:function(e,t,i,a,n){var r,s=this;this.setFillStyles(n);var o=0;this.canvases.forEach((function(n){var l=n.getContext("2d"),c=l.canvas.width;if(!(o>t+r)){if(o+c>t){r=l.measureText(e).width;var u=t-r/2;"interval"==s.tierType&&(u=t+a/2);var h=i+a/2;l.fillText(e,u-o,h)}o+=c,s.setFillStyles(s.params.Color)}}))}}]),e}(),Yi={name:"MovieAnnotaion",components:{MToolBar:Xt,MTierList:di,MSettingMenu:ei},data:function(){return{debug:!1,ws:null,isLoading:!0,background:"grey lighten-3",frameOffset:1,text:"",currentTier:null,currentIdx:null,menuFuncs:[],tiers:[{name:"Interval",tierType:"interval",items:[]},{name:"Point",tierType:"point",items:[]}],videoHeight:0,videoStyle:{width:"100%",height:"auto"},options:{waveColor:bt["a"].grey.base,progressColor:bt["a"].grey.darken4,loaderColor:bt["a"].grey.darken4,cursorColor:bt["a"].teal.base,minPxPerSec:100,height:70,scrollParent:!0,normalize:!0}}},computed:{item:{get:function(){return $.find(this.$route.params.id)},set:function(e){$.update({where:this.$route.params.id,data:e})}},debugItem:function(){var e={};return e.item=this.item,e.isLoading=this.isLoading,e},frameRate:function(){return 1/this.item.fps}},watch:{"item.dataUrl":function(){var e=this;this.$nextTick((function(){e.load()}))}},methods:{log:function(e,t){this.debug&&console.info(e,t)},load:function(){var e="".concat(this.$options.name,":load"),t=this.$refs.video;this.$refs.video?this.ws?this.ws.load(t):this.log(e,"no ws"):this.log(e,"no video")},initWs:function(){var e="".concat(this.$options.name,":initWs");this.ws&&(this.log(e,"destroy:ws"),this.ws.destroy(),this.ws=null),this.log(e,"init:ws");var t=this.options;for(var i in t.container="#waveform",t.backend="MediaElement",t.plugins=[Ui.create({container:"#wave-spectrogram",labels:!0}),qi.create({container:"#wave-timeline"}),Hi.create({container:"#wave-minimap",height:20})],this.ws=Ni.create(t),this.tiers){var a=Gi.create({container:"#wave-multiline",name:this.tiers[i].name,tierType:this.tiers[i].tierType,items:this.tiers[i].items});this.ws.addPlugin(a).initPlugin("multiline")}this.ws.on("interaction",this.syncVideos),this.ws.on("ready",this.onRedy),this.ws.on("destroy",this.onDestroy),this.ws.on("error",this.onError),this.ws.on("multiline-update-current",this.onUpdateMultiline)},setVideoHeight:function(){var e=this,t="".concat(this.$options.name,":setVideoHeight");this.$nextTick((function(){var i=e.$refs.videoCard?e.$refs.videoCard.$el:null;i&&(e.videoHeight=i.clientHeight),e.log(t,e.videoHeight)}))},addTier:function(e,t){this.tiers.push({name:e,tierType:t,items:[]});var i=Gi.create({name:this.tiers[this.tiers.length-1].name,container:"#wave-multiline",tierType:this.tiers[this.tiers.length-1].tierType,items:this.tiers[this.tiers.length-1].items});this.ws.addPlugin(i).initPlugin("multiline")},play:function(){this.syncVideos(),this.$refs.videoPre.play(),this.$refs.videoPos.play(),this.ws.play()},pause:function(){this.$refs.videoPre.pause(),this.$refs.videoPos.pause(),this.ws.pause(),this.syncVideos()},syncVideos:function(){var e="".concat(this.$options.name,":syncVideos"),t=this.getCurrentTime(),i=this.frameOffset*this.frameRate;if(this.log(e,t),t-i>0){var a=t-i;this.$refs.videoPre.currentTime=a}else this.$refs.videoPre.currentTime=0,this.log(e+"video-pre: setCurrentTime","".concat(t-i," is less than 0"));if(i+t<this.getDuration()){this.log(e,"video-pos: setCurrentTime");var n=t+i;this.$refs.videoPos.currentTime=n}else this.$refs.videoPos.currentTime=this.getDuration(),this.log(e+"video-pos: setCurrentTime","".concat(t+i," is more than ").concat(this.getDuration()))},getCurrentTime:function(){return this.ws.getCurrentTime()},getDuration:function(){return this.ws.getDuration()},onChangeText:function(e){this.currentTier&&this.currentTier.putText(this.currentIdx,e)},onEnterText:function(e){this.currentTier&&this.currentTier.putText(this.currentIdx,e.target.value)},onRedy:function(){var e="".concat(this.$options.name,":onRedy"),t=this;this.setVideoHeight(),this.menuFuncs=[{title:"Add Interval Tier",callback:function(){var e=t.ws.getTierNum();t.addTier("tier-".concat(e+1),"interval")}},{title:"Add Point Tier",callback:function(){var e=t.ws.getTierNum();t.addTier("tier-".concat(e+1),"point")}}],this.log(e),this.isLoading=!1},onDestroy:function(e){var t="".concat(this.$options.name,":onDestroy");this.log(t,e)},onError:function(e){var t="".concat(this.$options.name,":onError");this.log(t,e)},onUpdateFiler:function(e){var t="".concat(this.$options.name,":onUpdateFiler");this.log(t,e),this.ws.backend.setFilters(e)},onUpdateMultiline:function(e){e.item&&(this.text=e.item.text,this.currentTier=this.ws.multiline.tiers[e.name],this.currentIdx=e.id,this.$refs.textField.focus())},onResize:function(){this.setVideoHeight()}},mounted:function(){var e="".concat(this.$options.name,":mounted");this.log(e),this.item?(this.initWs(),this.load()):this.$router.push({name:"Home"}),this.$nextTick((function(){}))}},Zi=Yi,Ji=i("62ad"),Ki=i("8e36"),Qi=i("0fd9"),ea=i("afd9"),ta=i("269a"),ia=i.n(ta),aa=i("dc22"),na=Object(h["a"])(Zi,pt,gt,!1,null,null,null),ra=na.exports;f()(na,{VBtn:m["a"],VCard:z["a"],VCardActions:N["a"],VCol:Ji["a"],VContainer:ge["a"],VIcon:p["a"],VProgressLinear:Ki["a"],VRow:Qi["a"],VSpacer:g["a"],VSystemBar:ea["a"],VTextField:be["a"]}),ia()(na,{Resize:aa["a"]});var sa=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"image-annotation"},[i("h1",[e._v("This is an image-annotation page")]),i("p",[e._v("id is "+e._s(e.id))])])},oa=[],la={name:"ImageAnnotaion",props:{id:{type:String,required:!0}}},ca=la,ua=Object(h["a"])(ca,sa,oa,!1,null,null,null),ha=ua.exports,da=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"component-debug"},[i("h1",[e._v("Debug components")]),i("v-card",{staticClass:"mx-auto"},[i("v-toolbar",{attrs:{color:"primary",dark:""}},[i("v-toolbar-title",[e._v("動画関連")]),i("v-spacer"),e.video.name&&e.video.fps?i("v-toolbar-title",[e._v(" "+e._s(e.video.name)+" ("+e._s(e.video.fps)+") ")]):e._e()],1),i("v-container",[i("m-movie-input",{model:{value:e.video,callback:function(t){e.video=t},expression:"video"}}),i("v-card",{staticClass:"mx-auto"},[i("v-toolbar",{attrs:{color:"blue-grey",dark:""}},[i("v-toolbar-title",[e._v(" Open CV DEMO ")]),i("v-spacer"),i("v-menu",{attrs:{bottom:"",left:"","close-on-content-click":!1},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[i("v-btn",e._g({attrs:{icon:""}},a),[i("v-icon",[e._v("mdi-cog")])],1)]}}]),model:{value:e.conf.show,callback:function(t){e.$set(e.conf,"show",t)},expression:"conf.show"}},[i("v-list",{attrs:{subheader:""}},[i("v-subheader",[e._v(" background-subtractor ")]),i("v-list-item",[i("v-list-item-title",[i("v-text-field",{attrs:{label:"history"},model:{value:e.conf.bs.history,callback:function(t){e.$set(e.conf.bs,"history",t)},expression:"conf.bs.history"}})],1)],1),i("v-list-item",[i("v-list-item-title",[i("v-text-field",{attrs:{label:"threshold"},model:{value:e.conf.bs.threshold,callback:function(t){e.$set(e.conf.bs,"threshold",t)},expression:"conf.bs.threshold"}})],1)],1),i("v-list-item",[i("v-list-item-title",[i("v-switch",{attrs:{label:"detectShadows"},model:{value:e.conf.bs.detectShadows,callback:function(t){e.$set(e.conf.bs,"detectShadows",t)},expression:"conf.bs.detectShadows"}})],1)],1)],1)],1)],1),e.video.dataUrl&&e.video.file?i("v-container",[i("v-row",[i("v-card",{staticClass:"ma-1"},[i("v-system-bar",{attrs:{dark:"",color:"primary"}},[i("span",[e._v("origin")])]),i("video",{ref:"video",attrs:{width:e.video.size.width,height:e.video.size.height,src:e.video.dataUrl}})],1),i("v-card",{staticClass:"ma-1"},[i("v-system-bar",{attrs:{dark:"",color:"primary"}},[i("span",[e._v("background-subtractor")])]),i("background-subtractor",{ref:"backgroundSubtractor",attrs:{dataUrl:e.video.dataUrl,fps:e.video.fps,width:e.video.size.width,height:e.video.size.height,history:Number(e.conf.bs.history),threshold:Number(e.conf.bs.threshold),detectShadows:e.conf.bs.detectShadows}})],1),i("v-card",{staticClass:"ma-1"},[i("v-system-bar",{attrs:{dark:"",color:"primary"}},[i("span",[e._v("optical-flow")])]),i("optical-flow",{ref:"opticalFlow",attrs:{dataUrl:e.video.dataUrl,fps:e.video.fps,width:e.video.size.width,height:e.video.size.height}})],1),i("v-card",{staticClass:"ma-1"},[i("v-system-bar",{attrs:{dark:"",color:"primary"}},[i("span",[e._v("mean-shift")])]),i("mean-shift",{ref:"meanShift",attrs:{dataUrl:e.video.dataUrl,fps:e.video.fps,width:e.video.size.width,height:e.video.size.height}})],1)],1)],1):e._e()],1)],1),i("v-card-actions",[i("v-btn",{attrs:{text:""},on:{click:e.prev}},[e._v(" prev ")]),i("v-btn",{attrs:{text:""},on:{click:e.play}},[e._v("Play")]),i("v-btn",{attrs:{text:""},on:{click:e.pause}},[e._v(" Pause ")]),i("v-btn",{attrs:{text:""},on:{click:e.next}},[e._v("next")])],1)],1)],1)},fa=[],va=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"background-subtractor"},[i("video",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"video",attrs:{width:e.width,height:e.height,muted:"",src:e.dataUrl},domProps:{muted:!0},on:{timeupdate:e.onTimeupdate,loadeddata:e.onLoadeddata}}),i("canvas",{ref:"canvas",staticStyle:{border:"1px solid #000000"},attrs:{width:e.width,height:e.height}})])},ma=[],pa=(i("5319"),function(e){var t=e.split(" ");return 1==t.length?bt["a"][t[0]].base:bt["a"][t[0]][t[1].replace("-","")]}),ga=function(e){if(7!==e.length)return"rgb(255,255,255)";if("#"===e.split("")[0]&&(e=e.substring(1)),3===e.length){var t=e.split("");e=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]}var i=parseInt(e.substring(0,2),16),a=parseInt(e.substring(2,4),16),n=parseInt(e.substring(4,6),16);return"rgb(".concat(i,",").concat(a,",").concat(n,")")},ba=function(e){var t=pa(e);if(t)return ga(t)},ya={getCode:pa,getRgb:ba,css2rgb:ga},wa={name:"BackgroundSubtractor",props:{dataUrl:{type:String,require:!0},fps:{type:Number,require:!0},width:{type:Number,require:!0},height:{type:Number,require:!0},history:{type:Number,default:50},threshold:{type:Number,default:16},detectShadows:{type:Boolean,default:!1}},data:function(){return{cap:null,video:null,frame:null,fgmask:null}},computed:{fgbg:function(){var e="".concat(this.$options.name,":computed:fgbg");return console.info(e),new cv.BackgroundSubtractorMOG2(this.history,this.threshold,this.detectShadows)}},methods:{onLoadeddata:function(){var e="".concat(this.$options.name,":onLoadeddata");this.setCurrentTime(1/this.fps);try{var t=this.$refs.canvas,i=t.getContext("2d");i.fillStyle=ya.getRgb("grey"),i.fillRect(0,0,this.width,this.height),this.cap.read(this.frame),cv.imshow(this.$refs.canvas,this.frame),console.info(e)}catch(a){console.error(e,a)}},onTimeupdate:function(){var e="".concat(this.$options.name,":onTimeupdate");try{this.cap.read(this.frame),this.fgbg.apply(this.frame,this.fgmask),cv.imshow(this.$refs.canvas,this.fgmask)}catch(t){console.error(e,t)}},play:function(){this.video.play()},pause:function(){this.video.pause()},setCurrentTime:function(e){var t="".concat(this.$options.name,":setCurrentTime");e>0&&e<this.video.duration?(this.video.currentTime=e,console.info(t,this.video.currentTime)):console.error(t,this.video.currentTime)}},mounted:function(){this.video=this.$refs.video,this.cap=new cv.VideoCapture(this.video),this.frame=new cv.Mat(this.height,this.width,cv.CV_8UC4),this.fgmask=new cv.Mat(this.height,this.width,cv.CV_8UC1)}},ka=wa,xa=Object(h["a"])(ka,va,ma,!1,null,null,null),Ca=xa.exports,_a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"optical-flow"},[i("video",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"video",attrs:{width:e.width,height:e.height,muted:"",src:e.dataUrl},domProps:{muted:!0},on:{timeupdate:e.onTimeupdate,loadeddata:e.onLoadeddata}}),i("canvas",{ref:"canvas",staticStyle:{border:"1px solid #000000"},attrs:{width:e.width,height:e.height}})])},Sa=[],Pa={name:"OpticalFlow",props:{dataUrl:{type:String,require:!0},fps:{type:Number,require:!0},width:{type:Number,require:!0},height:{type:Number,require:!0}},data:function(){return{video:null,cap:null,frame2:null,next:null,prvs:null,flow:null,flowVec:null,ang:null,mag:null,hsv0:null,hsv:null,hsv2:null,hsvVec:null,rgb:null}},computed:{},methods:{onLoadeddata:function(){var e="".concat(this.$options.name,":onLoadeddata");this.cap.read(this.frame2),cv.imshow(this.$refs.canvas,this.frame2),console.log(e)},onTimeupdate:function(){var e="".concat(this.$options.name,":onTimeupdate");try{this.cap.read(this.frame2),cv.cvtColor(this.frame2,this.next,cv.COLOR_RGBA2GRAY),cv.calcOpticalFlowFarneback(this.prvs,this.next,this.flow,.5,3,15,3,5,1.2,0),cv.split(this.flow,this.flowVec);var t=this.flowVec.get(0),i=this.flowVec.get(1);cv.cartToPolar(t,i,this.mag,this.ang),t.delete(),i.delete(),this.ang.convertTo(this.hsv0,cv.CV_8UC1,180/Math.PI/2),cv.normalize(this.mag,this.hsv2,0,255,cv.NORM_MINMAX,cv.CV_8UC1),cv.merge(this.hsvVec,this.hsv),cv.cvtColor(this.hsv,this.rgb,cv.COLOR_HSV2RGB),cv.imshow(this.$refs.canvas,this.rgb),this.next.copyTo(this.prvs)}catch(a){console.error(a)}console.log(e)},play:function(){this.video.play()},pause:function(){this.video.pause()},setCurrentTime:function(e){var t="".concat(this.$options.name,":setCurrentTime");e>0&&e<this.video.duration?(this.video.currentTime=e,console.info(t,this.video.currentTime)):console.error(t,this.video.currentTime)}},mounted:function(){this.video=this.$refs.video,this.cap=new cv.VideoCapture(this.video),this.prvs=new cv.Mat,this.frame2=new cv.Mat(this.height,this.width,cv.CV_8UC4),this.next=new cv.Mat(this.height,this.width,cv.CV_8UC1),this.flow=new cv.Mat(this.height,this.width,cv.CV_32FC2),this.flowVec=new cv.MatVector,this.mag=new cv.Mat(this.height,this.width,cv.CV_32FC1),this.ang=new cv.Mat(this.height,this.width,cv.CV_32FC1);var e=new cv.Mat(this.height,this.width,cv.CV_8UC4);this.cap.read(e),cv.cvtColor(e,this.prvs,cv.COLOR_RGBA2GRAY),e.delete(),this.hsv=new cv.Mat,this.hsv0=new cv.Mat(this.height,this.width,cv.CV_8UC1);var t=new cv.Mat(this.height,this.width,cv.CV_8UC1,new cv.Scalar(255));this.hsv2=new cv.Mat(this.height,this.width,cv.CV_8UC1),this.hsvVec=new cv.MatVector,this.hsvVec.push_back(this.hsv0),this.hsvVec.push_back(t),this.hsvVec.push_back(this.hsv2),this.rgb=new cv.Mat(this.height,this.width,cv.CV_8UC3)}},Ea=Pa,Ta=Object(h["a"])(Ea,_a,Sa,!1,null,null,null),ja=Ta.exports,Ra=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"mean-shift"},[i("video",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"video",attrs:{width:e.width,height:e.height,muted:"",src:e.dataUrl},domProps:{muted:!0},on:{timeupdate:e.onTimeupdate,loadeddata:e.onLoadeddata}}),i("canvas",{ref:"canvas",staticStyle:{border:"1px solid #000000"},attrs:{width:e.width,height:e.height}})])},Ma=[],Oa=i("3835"),Aa={name:"MeanShift",props:{dataUrl:{type:String,require:!0},fps:{type:Number,require:!0},width:{type:Number,require:!0},height:{type:Number,require:!0}},data:function(){return{video:null,cap:null,frame:null,hsv:null,hsvVec:null,roiHist:null,dst:null,trackBox:null,termCrit:null}},methods:{onLoadeddata:function(){var e="".concat(this.$options.name,":onLoadeddata");this.cap.read(this.frame),cv.imshow(this.$refs.canvas,this.frame),console.info(e,this.video.currentTime)},onTimeupdate:function(){var e="".concat(this.$options.name,":onTimeupdate");try{this.cap.read(this.frame),cv.cvtColor(this.frame,this.hsv,cv.COLOR_RGBA2RGB),cv.cvtColor(this.hsv,this.hsv,cv.COLOR_RGB2HSV),cv.calcBackProject(this.hsvVec,[0],this.roiHist,this.dst,[0,180],1);var t=cv.CamShift(this.dst,this.trackWindow,this.termCrit),i=Object(Oa["a"])(t,2);this.trackBox=i[0],this.trackWindow=i[1];var a=cv.rotatedRectPoints(this.trackBox);cv.line(this.frame,a[0],a[1],[255,0,0,255],3),cv.line(this.frame,a[1],a[2],[255,0,0,255],3),cv.line(this.frame,a[2],a[3],[255,0,0,255],3),cv.line(this.frame,a[3],a[0],[255,0,0,255],3),cv.imshow(this.$refs.canvas,this.frame)}catch(n){console.error(e,n)}},play:function(){this.video.play()},pause:function(){this.video.pause()},setCurrentTime:function(e){e>0&&e<this.video.duration&&(this.video.currentTime=e)}},mounted:function(){this.video=this.$refs.video,this.cap=new cv.VideoCapture(this.video),this.frame=new cv.Mat(this.height,this.width,cv.CV_8UC4),this.trackWindow=new cv.Rect(150,60,63,125);var e=this.frame.roi(this.trackWindow),t=new cv.Mat;cv.cvtColor(e,t,cv.COLOR_RGBA2RGB),cv.cvtColor(t,t,cv.COLOR_RGB2HSV);var i=new cv.Mat,a=new cv.Scalar(30,30,0),n=new cv.Scalar(180,180,180),r=new cv.Mat(t.rows,t.cols,t.type(),a),s=new cv.Mat(t.rows,t.cols,t.type(),n);cv.inRange(t,r,s,i),this.roiHist=new cv.Mat;var o=new cv.MatVector;o.push_back(t),cv.calcHist(o,[0],i,this.roiHist,[180],[0,180]),cv.normalize(this.roiHist,this.roiHist,0,255,cv.NORM_MINMAX),e.delete(),t.delete(),i.delete(),r.delete(),s.delete(),o.delete(),this.termCrit=new cv.TermCriteria(cv.TERM_CRITERIA_EPS|cv.TERM_CRITERIA_COUNT,10,1),this.hsv=new cv.Mat(this.height,this.width,cv.CV_8UC3),this.hsvVec=new cv.MatVector,this.hsvVec.push_back(this.hsv),this.dst=new cv.Mat,this.trackBox=null}},$a=Aa,Va=Object(h["a"])($a,Ra,Ma,!1,null,null,null),Ia=Va.exports,La={name:"ComponentDebug",components:{MMovieInput:fe,BackgroundSubtractor:Ca,OpticalFlow:ja,MeanShift:Ia},data:function(){return{video:{loading:!1,name:null,dataUrl:null,fps:null,size:{width:null,height:null}},conf:{show:!1,bs:{history:50,threshold:16,detectShadows:!1}}}},methods:{play:function(){var e=this.$refs.video;e.play(),this.$refs.backgroundSubtractor.play(),this.$refs.meanShift.play(),this.$refs.opticalFlow.play(),this.$refs.videoArray.play()},pause:function(){var e=this.$refs.video;e.pause(),this.$refs.backgroundSubtractor.pause(),this.$refs.meanShift.pause(),this.$refs.opticalFlow.pause(),this.$refs.videoArray.pause()},prev:function(){var e=this.$refs.video,t=1/this.video.fps,i=Math.max(0,e.currentTime-t);e.currentTime=i,this.$refs.backgroundSubtractor.setCurrentTime(i),this.$refs.meanShift.setCurrentTime(i),this.$refs.opticalFlow.setCurrentTime(i),this.$refs.videoArray.prev()},next:function(){var e=this.$refs.video,t=1/this.video.fps,i=Math.min(e.duration,e.currentTime+t);e.currentTime=i,this.$refs.backgroundSubtractor.setCurrentTime(i),this.$refs.meanShift.setCurrentTime(i),this.$refs.opticalFlow.setCurrentTime(i),this.$refs.videoArray.next()}}},Wa=La,Fa=i("b73d"),Da=Object(h["a"])(Wa,da,fa,!1,null,null,null),za=Da.exports;f()(Da,{VBtn:m["a"],VCard:z["a"],VCardActions:N["a"],VContainer:ge["a"],VIcon:p["a"],VList:Re["a"],VListItem:Oe["a"],VListItemTitle:$e["c"],VMenu:At["a"],VRow:Qi["a"],VSpacer:g["a"],VSubheader:Et["a"],VSwitch:Fa["a"],VSystemBar:ea["a"],VTextField:be["a"],VToolbar:$t["a"],VToolbarTitle:b["a"]}),n["a"].use(qe["a"]);var Na=[{path:"/",name:"Home",component:at},{path:"/about",name:"About",component:ct},{path:"/config",name:"Config",component:mt},{path:"/movies/:id",name:"MovieAnnotation",component:ra,props:!0},{path:"/movies/:id",name:"ImageAnnotation",component:ha,props:!0},{path:"/debug/",name:"ComponentDebug",component:za,props:!0}],Ba=new qe["a"]({mode:"history",base:"/",routes:Na}),Ua=Ba,qa=i("2f62"),Ha="current",Xa="".concat(Ha,":MUTATION"),Ga="".concat(Ha,":ACTION"),Ya={namespaced:!0,state:{name:null,fileSize:null,fileType:null,fps:null,dataUrl:null,lastModifiedDate:null,currentTime:null,size:{width:null,height:null},videoStream:{bitrate:null,codec_name:null,fps:null,pix_fmt:null,tbc:null,tbn:null,tbr:null},audioStream:{codec_name:null,bitrate:null,channel_layout:null,sample_fmt:null,sample_rate:null}},mutations:{setName:function(e,t){console.info("".concat(Xa,":setName"),t),e.name=String(t)},setCurrentTime:function(e,t){console.info("".concat(Xa,":setCurrentTime"),t),e.currentTime=t},setLastModifiedData:function(e,t){console.info("".concat(Xa,":setLastModifiedData"),t),e.lastModifiedDate=t},setFileSize:function(e,t){console.info("".concat(Xa,":setFileSize"),t),e.fileSize=t},setFileType:function(e,t){console.info("".concat(Xa,":setFileType"),t),e.fileType=t},setFps:function(e,t){console.info("".concat(Xa,":setFps"),t),e.fps=Number(t)},setDataUrl:function(e,t){console.info("".concat(Xa,":setDataUrl"),t.split(",")[0]),e.dataUrl=String(t)},setSize:function(e,t){console.info("".concat(Xa,":setSize"),t),e.size.width=t.width,e.size.height=t.height},setWidth:function(e,t){console.info("".concat(Xa,":setWidth"),t),e.size.width=t},setHeight:function(e,t){console.info("".concat(Xa,":setHeight"),t),e.size.height=t},setVideoStream:function(e,t){console.info("".concat(Xa,":setVideoStream"),t),e.videoStream.codec_name=String(t.codec_name),e.videoStream.pix_fmt=String(t.pix_fmt),e.videoStream.bitrate=Number(t.bitrate),e.videoStream.fps=Number(t.fps),e.videoStream.tbc=Number(t.tbc),e.videoStream.tbn=Number(t.tbn),e.videoStream.tbr=Number(t.tbr)},setAudioStream:function(e,t){console.info("".concat(Xa,":setAudioStream"),t),e.audioStream.bitrate=t.bitrate,e.audioStream.channel_layout=t.channel_layout,e.audioStream.codec_name=t.codec_name,e.audioStream.sample_fmt=t.sample_fmt,e.audioStream.sample_rate=t.sample_rate}},actions:{setItem:function(e,t){console.info("".concat(Ga,":setItem"),t),e.commit("setName",t.name),e.commit("setLastModifiedData",t.lastModifiedDate),e.commit("setFileSize",t.fileSize),e.commit("setFileType",t.fileType),e.commit("setFps",t.fps),e.commit("setDataUrl",t.dataUrl),e.commit("setSize",t.size),e.commit("setVideoStream",t.videoStream),e.commit("setAudioStream",t.audioStream)},setName:function(e,t){console.info("".concat(Ga,":setName"),t),e.commit("setName",t)},setFps:function(e,t){console.info("".concat(Ga,":setFps"),t),e.commit("setFps",t)},setCurrentTime:function(e,t){console.info("".concat(Ga,":setCurrentTime"),t),e.commit("setCurrentTime",t)},setDataUrl:function(e,t){console.info("".concat(Ga,":setDataUrl"),t),e.commit("setDataUrl",t)},setSize:function(e,t){console.info("".concat(Ga,":setSize"),t),e.commit("setSize",t)},setWidth:function(e,t){console.info("".concat(Ga,":setWidth"),t),e.commit("setWidth",t)},setMovieHeight:function(e,t){console.info("".concat(Ga,":setHeight"),t),e.commit("setHeight",t)},setVideoStream:function(e,t){console.info("".concat(Ga,":setVideoStream"),t),e.commit("setVideoStream",t)},setAudioStream:function(e,t){console.info("".concat(Ga,":setAudioStream"),t),e.commit("setAudioStream",t)}}},Za=new R["b"].Database;Za.register($),Za.register(M),Za.register(O),Za.register(A),n["a"].use(qa["a"]);var Ja=new qa["a"].Store({state:{appName:"MRI Vuewer",appVersion:"2.0"},mutations:{},actions:{},modules:{current:Ya},plugins:[R["b"].install(Za)]}),Ka=i("f309"),Qa={badge:"バッジ",close:"閉じる",dataIterator:{noResultsText:"検索結果が見つかりません。",loadingText:"項目をロード中です..."},dataTable:{itemsPerPageText:"1ページあたりの行数：",ariaLabel:{sortDescending:"降順の並び替え。",sortAscending:"昇順の並び替え。",sortNone:"ソートされていません。",activateNone:"ソートを削除するには有効にしてください。",activateDescending:"降順の並び替えのためには有効にしてください。",activateAscending:"昇順のソートのためには有効にしてください。"},sortBy:"ソート方式"},dataFooter:{itemsPerPageText:"1ページあたりの件数：",itemsPerPageAll:"すべて",nextPage:"次のページ",prevPage:"前のページ",firstPage:"一ページ目",lastPage:"最後のページ",pageText:"{0}-{1} 件目 / {2}件"},datePicker:{itemsSelected:"{0}日付選択"},noDataText:"データはありません。",carousel:{prev:"前のビジュアル",next:"次のビジュアル",ariaLabel:{delimiter:"Carousel slide {0} of {1}"}},calendar:{moreEvents:"さらに{0}"},fileInput:{counter:"{0} ファイル",counterSize:"{0} ファイル (合計 {1})"},timePicker:{am:"AM",pm:"PM"},validate:{required:"このフィールドは必須です",lessThen:"このフィールドは{0}文字以下でなければいけません",moreThen:"このフィールドは{0}文字以上でなければいけません",isFloat:"このフィールドは浮動小数型です"},baseFromDialog:{open:"ダイアログを開く",hint:"* は必須フィールドです",close:"閉じる",save:"保存"},movieUploadDialog:{file:{title:"動画ファイル",hint:"動画ファイルは mp4, webm  または ogv 形式に対応しています"},name:{title:"表示名",hint:"動画ファイルを登録する際の表示名です"},fps:{title:"動画フレームレート",hint:"動画の FPS を登録してください"}},sidebar:{files:{title:"アノテーション",add:"新規ファイル",list:"登録ファイル"},cache:{destroy:"キャッシュの削除",export:"キャッシュの取り出し",import:"キャッシュの読み込み"}},home:{disc:"MP4 動画アノテーションツール",upload:{title:"動画登録",btn:"アップロード",hint:"任意の動画ファイルをアノテーション用に取り込みます"},demo:{title:"サンプル",btn:"サンプル動画読み込み",hint:"サンプル動画を使いアノテーション機能を試します"}},movieAnnotation:{info:{title:"動画詳細",videoStream:{codec:{title:"ビデオコーディック"},bitrate:{title:"ビットレート"},fps:{title:"fps"},tbr:{title:"tbr",help:"ビデオストリームから推測された動画フレームレート"},tbn:{title:"tbn",help:"コンテナから取得された動画ストリームのタイムベース"},tbc:{title:"tbc",help:"特定のストリームに使用されるコーデック独自のタイムベース"}},audioStream:{codec:{title:"コーディック"},bitrate:{title:"ビットレート"},channel_layout:{title:"チャンネルレイアウト"},sample_rate:{title:"サンプリングレート"}}}}},en={badge:"Badge",close:"Close",dataIterator:{noResultsText:"No matching records found",loadingText:"Loading items..."},dataTable:{itemsPerPageText:"Rows per page:",ariaLabel:{sortDescending:"Sorted descending.",sortAscending:"Sorted ascending.",sortNone:"Not sorted.",activateNone:"Activate to remove sorting.",activateDescending:"Activate to sort descending.",activateAscending:"Activate to sort ascending."},sortBy:"Sort by"},dataFooter:{itemsPerPageText:"Items per page:",itemsPerPageAll:"All",nextPage:"Next page",prevPage:"Previous page",firstPage:"First page",lastPage:"Last page",pageText:"{0}-{1} of {2}"},datePicker:{itemsSelected:"{0} selected"},noDataText:"No data available",carousel:{prev:"Previous visual",next:"Next visual",ariaLabel:{delimiter:"Carousel slide {0} of {1}"}},calendar:{moreEvents:"{0} more"},fileInput:{counter:"{0} files",counterSize:"{0} files ({1} in total)"},timePicker:{am:"AM",pm:"PM"},validate:{required:"This field is required",lessThen:"This field must be less than {0} characters",moreThen:"This field must be more than {0} characters",isFloat:"This is a float field"},movieUploadDialog:{file:{title:"Your movie",hint:"supported format is mp4, webm and ogv"},name:{title:"Display name",hint:"Display name of your movie"},fps:{title:"FPS",hint:"Register your video fps"}},baseFromDialog:{open:"Open Dialog",hint:"*indicates required field",close:"Close",save:"Save"},sidebar:{files:{title:"Annotation",add:"File upload",list:"Registered files"},cache:{destroy:"Destroy an app cache",export:"Export an app cache",import:"Import an app cache"}},home:{disc:"Annotation tool for web videos",upload:{title:"Register your video",btn:"Upload",hint:"Import your video file for annotation"},demo:{title:"Live demo",btn:"Go to a sample movie",hint:"Try the annotation function using a sample video"}},movieAnnotation:{info:{title:"video format",videoStream:{codec:{title:"codec"},bitrate:{title:"bitrate"},fps:{title:"fps"},tbr:{title:"tbr",help:"tbr is guessed from the video stream and is the value users want to see when they look for the video frame rate"},tbn:{title:"tbn",help:"the time base in AVStream that has come from the container"},tbc:{title:"tbc",help:"the time base in AVCodecContext for the codec used for a particular stream"}},audioStream:{bitrate:{title:"bitrate"},channel_layout:{title:"channel layout"},codec:{title:"codec"},sample_rate:{title:"sampling rate"}}}}},tn={badge:"徽章",close:"关闭",dataIterator:{noResultsText:"没有符合条件的结果",loadingText:"加载中……"},dataTable:{itemsPerPageText:"每页数目：",ariaLabel:{sortDescending:"：降序排列。",sortAscending:"：升序排列。",sortNone:"：未排序。",activateNone:"点击以移除排序。",activateDescending:"点击以降序排列。",activateAscending:"点击以升序排列。"},sortBy:"排序方式"},dataFooter:{itemsPerPageText:"每页数目：",itemsPerPageAll:"全部",nextPage:"下一页",prevPage:"上一页",firstPage:"首页",lastPage:"尾页",pageText:"{0}-{1} 共 {2}"},datePicker:{itemsSelected:"已选择 {0}"},noDataText:"没有数据",carousel:{prev:"上一张",next:"下一张",ariaLabel:{delimiter:"Carousel slide {0} of {1}"}},calendar:{moreEvents:"还有 {0} 项"},fileInput:{counter:"{0} 个文件",counterSize:"{0} 个文件（共 {1}）"},timePicker:{am:"AM",pm:"PM"},validate:{required:"這是必填欄",lessThen:"此字段必須少於{0}個字符",moreThen:"此字段必須超過{0}個字符",isFloat:"這是一個浮動字段"},movieUploadDialog:{file:{title:"您的電影",hint:"支持的格式是mp4，webm和ogv"},name:{title:"顯示名稱",hint:"顯示電影的名稱"},fps:{title:"每秒幀數",hint:"註冊您的視頻fps"}},baseFromDialog:{open:"打開對話框",hint:"*表示必填字段",close:"取消",save:"保存到"},sidebar:{files:{title:"註釋",add:"新文件",list:"註冊文件"},cache:{destroy:"銷毀應用程序緩存",export:"導出應用程序緩存",import:"導入應用程序緩存"}},home:{disc:"網絡視頻註釋工具",upload:{title:"註冊視頻",btn:"上載",hint:"導入任何視頻文件進行註釋"},demo:{title:"現場演示",btn:"觀看電影樣本",hint:"使用示例視頻嘗試註釋功能"}},movieAnnotation:{info:{title:"影片格式",videoStream:{codec:{title:"編解碼器"},bitrate:{title:"比特率"},fps:{title:"fps"},tbr:{title:"tbr",help:"tbr 是從視頻流中推測出來的，是用戶尋找視頻幀速率時希望看到的值"},tbn:{title:"tbn",help:"影片流中來自容器的時基"},tbc:{title:"tbc",help:"電影編解碼器上下文中用於特定流的編解碼器的時基"}},audioStream:{codec:{title:"編解碼器"},bitrate:{title:"比特率"},channel_layout:{title:"頻道佈局"},sample_rate:{title:"採樣率"}}}}};n["a"].use(Ka["a"]);var an=new Ka["a"]({theme:{themes:{light:{primary:bt["a"].blueGrey,secondary:bt["a"].blueGrey.darken3,accent:bt["a"].teal.darken3},dark:{primary:bt["a"].blueGrey.lighten3}}},lang:{locales:{ja:Qa,en:en,zhHans:tn},current:"zhHans"}});n["a"].config.productionTip=!1,new n["a"]({router:Ua,store:Ja,vuetify:an,render:function(e){return e(Be)}}).$mount("#app")}});
//# sourceMappingURL=app.654c0d41.js.map